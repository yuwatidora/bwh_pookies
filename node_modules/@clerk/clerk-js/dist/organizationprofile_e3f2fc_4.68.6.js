"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[229],{4095:function(e,i,t){t.d(i,{l:function(){return h}});var a=t(2903),o=t(221),n=t(2784),r=t(8173),l=t(3476),s=t(8690),d=t(5802),c=t(4334),u=t(3736),g=t(1609),m=t(9654);const v=e=>/^\S+@\S+\.\S+$/.test(e),h=e=>{const{navigate:i}=(0,u.useRouter)(),{onSuccess:t,onReset:d=(()=>i("..")),resetButtonLabel:m}=e,{organization:h,invitations:p}=(0,r.useCoreOrganization)({invitations:{pageSize:10,keepPreviousData:!0}}),f=(0,s.useCardState)(),{t:b,locale:P}=(0,c.zJ)(),[y,Z]=(0,n.useState)(!1),S=(0,g.Yp)("emailAddress","",{type:"text",label:(0,c.u1)("formFieldLabel__emailAddresses")}),_=(0,g.Yp)("role","",{label:(0,c.u1)("formFieldLabel__role")});if(!h)return null;const{props:{setError:C,setWarning:x,setSuccess:K,setInfo:T,validatePassword:B,setHasPassedComplexity:D,hasPassedComplexity:R,feedback:w,feedbackType:L,clearFeedback:F,...M}}=S,k=(!!S.value.length||y)&&!!_.value;return(0,a.BX)(s.Form.Root,{onSubmit:e=>{e.preventDefault();const i=new FormData(e.currentTarget);return h.inviteMembers({emailAddresses:S.value.split(","),role:i.get("role")}).then((async()=>{var e;return await(null===(e=null==p?void 0:p.revalidate)||void 0===e?void 0:e.call(p)),t()})).catch((e=>{var i,t,a;if((0,o.kD)(e)&&(e=>{var i,t,a,o;const n=new Set([...null!==(t=null===(i=e.meta)||void 0===i?void 0:i.emailAddresses)&&void 0!==t?t:[],...null!==(o=null===(a=e.meta)||void 0===a?void 0:a.identifiers)&&void 0!==o?o:[]]),r=S.value.split(",");S.setValue(r.filter((e=>!n.has(e))).join(","))})(e.errors[0]),(0,o.kD)(e)&&"duplicate_record"===(null===(t=null===(i=e.errors)||void 0===i?void 0:i[0])||void 0===t?void 0:t.code)){const i=(null===(a=e.errors[0].meta)||void 0===a?void 0:a.emailAddresses)||[];f.setError(b((0,c.u1)("organizationProfile.invitePage.detailsTitle__inviteFailed",{email_addresses:(0,g.z$)(i,P)})))}else(0,g.S3)(e,[],f.setError)}))},children:[(0,a.tZ)(s.Form.ControlRow,{elementId:S.id,children:(0,a.BX)(l.Flex,{direction:"col",gap:2,sx:{width:"100%"},children:[(0,a.tZ)(l.Text,{localizationKey:(0,c.u1)("formFieldLabel__emailAddresses")}),(0,a.tZ)(l.Text,{localizationKey:(0,c.u1)("formFieldInputPlaceholder__emailAddresses"),colorScheme:"neutral",sx:e=>({fontSize:e.fontSizes.$xs})}),(0,a.tZ)(s.TagInput,{...M,autoFocus:!0,validate:v,sx:{width:"100%"},validateUnsubmittedEmail:e=>Z(v(e))})]})}),(0,a.tZ)(z,{..._}),(0,a.BX)(s.FormButtonContainer,{children:[(0,a.tZ)(s.Form.SubmitButton,{block:!1,isDisabled:!k,localizationKey:(0,c.u1)("organizationProfile.invitePage.formButtonPrimary__continue")}),(0,a.tZ)(s.Form.ResetButton,{localizationKey:m||(0,c.u1)("userProfile.formButtonReset"),block:!1,onClick:d})]})]})},z=e=>{const{options:i,isLoading:t}=(0,d.e)();return(0,a.tZ)(s.Form.ControlRow,{elementId:e.id,children:(0,a.BX)(l.Flex,{direction:"col",gap:2,children:[(0,a.tZ)(l.Text,{localizationKey:e.label}),(0,a.tZ)(m.DQ,{...e.props,roles:i,isDisabled:t,onChange:i=>e.setValue(i),triggerSx:e=>({width:e.sizes.$48,justifyContent:"space-between",display:"flex"}),optionListSx:e=>({minWidth:e.sizes.$48})})]})})}},2848:function(e,i,t){t.d(i,{a:function(){return h},F:function(){return v}});var a=t(2903),o=t(996),n=t(5480),r=t(8173),l=t(3476),s=t(8690),d=t(4804),c=t(3736);const u=({__unstable_manageBillingUrl:e,__unstable_manageBillingMembersLimit:i})=>{const t=(0,c.useRouter)();return(0,a.BX)(l.Flex,{sx:e=>({background:e.colors.$blackAlpha50,padding:e.space.$4,borderRadius:e.radii.$md}),children:[(0,a.tZ)(l.AlertIcon,{variant:"warning",colorScheme:"danger",sx:e=>({marginTop:e.space.$1})}),(0,a.BX)(l.Text,{variant:"regularRegular",sx:e=>({fontWeight:e.fontWeights.$normal,lineHeight:e.lineHeights.$tall}),children:["This organization is limited to ",(0,o.OR)(i)," members.",(0,a.tZ)("br",{}),(0,a.tZ)(l.Link,{variant:"regularRegular",sx:e=>({alignSelf:"flex-start",color:e.colors.$primary500,fontWeight:e.fontWeights.$normal}),onClick:()=>t.navigate((0,o.OR)(e)),children:"Upgrade for unlimited members"})]})]})};var g=t(4095),m=t(2609);const v=(0,s.withCardStateProvider)((()=>{const e=(0,l.localizationKeys)("organizationProfile.invitePage.title"),i=(0,l.localizationKeys)("organizationProfile.invitePage.subtitle"),t=(0,s.useCardState)(),d=(0,n.a2)({onNextStep:()=>t.setError(void 0)}),{organization:c}=(0,r.useCoreOrganization)(),{__unstable_manageBillingUrl:v,__unstable_manageBillingMembersLimit:z}=(0,r.useOrganizationProfileContext)();if(!c)return null;const p=!!z&&(0,o.OR)(z)<=c.pendingInvitationsCount+c.membersCount;return(0,a.BX)(n.en,{...d.props,children:[(0,a.BX)(s.ContentPage,{headerTitle:e,headerSubtitle:i,Breadcrumbs:m.G,children:[p&&v&&(0,a.tZ)(u,{__unstable_manageBillingUrl:v,__unstable_manageBillingMembersLimit:z}),(0,a.tZ)(g.l,{onSuccess:d.nextStep})]}),(0,a.tZ)(s.SuccessPage,{title:e,contents:(0,a.tZ)(h,{}),Breadcrumbs:m.G})]})})),h=()=>(0,a.BX)(l.Flex,{direction:"col",center:!0,gap:4,children:[(0,a.tZ)(s.IconCircle,{boxElementDescriptor:l.descriptors.invitationsSentIconBox,iconElementDescriptor:l.descriptors.invitationsSentIcon,icon:d.GT}),(0,a.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("organizationProfile.invitePage.successMessage")})]})},9654:function(e,i,t){t.d(i,{DQ:function(){return c},RN:function(){return d},wQ:function(){return l}});var a=t(2903),o=(t(2784),t(3476)),n=t(8690),r=t(5802);const l=e=>{const{headers:i,page:t,onPageChange:r,rows:l,isLoading:d,itemCount:c,itemsPerPage:u,pageCount:g,emptyStateLocalizationKey:m}=e,v=c>0?Math.max(0,(t-1)*u)+1:0,h=Math.min(t*u,c);return(0,a.BX)(o.Col,{gap:4,sx:{width:"100%"},children:[(0,a.tZ)(o.Flex,{sx:{overflowX:"auto"},children:(0,a.BX)(o.Table,{sx:{width:"100%"},children:[(0,a.tZ)(o.Thead,{children:(0,a.tZ)(o.Tr,{children:i.map(((e,i)=>(0,a.tZ)(o.Th,{elementDescriptor:o.descriptors.tableHead,localizationKey:e},i)))})}),(0,a.tZ)(o.Tbody,{children:d?(0,a.tZ)(o.Tr,{children:(0,a.tZ)(o.Td,{colSpan:4,children:(0,a.tZ)(o.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"}})})}):l.length?l:(0,a.tZ)(s,{localizationKey:m},"empty")})]})}),(0,a.tZ)(n.Pagination,{count:g,page:t,onChange:r,siblingCount:1,rowInfo:{allRowsCount:c,startingRow:v,endingRow:h}})]})},s=e=>(0,a.tZ)(o.Tr,{children:(0,a.tZ)(o.Td,{colSpan:4,children:(0,a.tZ)(o.Text,{localizationKey:e.localizationKey,sx:e=>({margin:"auto",display:"block",width:"fit-content",fontSize:e.fontSizes.$xs})})})}),d=e=>(0,a.tZ)(o.Tr,{...e,sx:e=>({":hover":{backgroundColor:e.colors.$blackAlpha50}})}),c=e=>{const{value:i,roles:t,onChange:o,isDisabled:l,triggerSx:s,optionListSx:d}=e,c=!t,u=[{label:"admin",value:"admin"},{label:"basic_member",value:"basic_member"}],{localizeCustomRole:g}=(0,r.q)(),m=[...t||[],...u,{label:"guest_member",value:"guest_member"}].find((e=>e.value===i)),v=(c?u:t).map((e=>({value:e.value,label:g(e.value)||e.label})));return(0,a.BX)(n.Select,{elementId:"role",options:v,value:i,onChange:e=>o(e.value),children:[(0,a.tZ)("input",{name:"role",type:"hidden",value:i}),(0,a.tZ)(n.SelectButton,{sx:s||(e=>({color:e.colors.$colorTextSecondary,backgroundColor:"transparent"})),isDisabled:l,children:g(null==m?void 0:m.value)||(null==m?void 0:m.label)}),(0,a.tZ)(n.SelectOptionList,{sx:d})]})}},6884:function(e,i,t){t.d(i,{D:function(){return r}});var a=t(2903),o=t(8690),n=t(4334);const r=e=>{const{organization:i,...t}=e;return(0,a.tZ)(o.AvatarUploader,{...t,title:(0,n.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,a.tZ)(o.OrganizationAvatar,{size:e=>e.sizes.$11,...i})})}},2609:function(e,i,t){t.d(i,{G:function(){return d},M:function(){return s}});var a=t(2903),o=(t(2784),t(5480)),n=t(8246),r=t(8173),l=t(8690);const s=e=>{const{organization:i}=(0,r.useCoreOrganization)(),{pages:t}=(0,r.useOrganizationProfileContext)(),{isAuthorizedUser:s}=(0,o.DD)((e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"})));return i?(0,a.BX)(l.NavbarContextProvider,{children:[(0,a.tZ)(l.NavBar,{header:(0,a.tZ)(l.OrganizationPreview,{size:"sm",organization:i,sx:e=>({margin:`0 0 ${e.space.$4} ${e.space.$2}`})}),routes:t.routes.filter((e=>e.id!==n.b.MEMBERS||e.id===n.b.MEMBERS&&s)),contentRef:e.contentRef}),e.children]}):null},d=e=>{const{pages:i}=(0,r.useOrganizationProfileContext)();return(0,a.tZ)(l.Breadcrumbs,{...e,pageToRootNavbarRoute:i.pageToRootNavbarRouteMap})}},4821:function(e,i,t){t.r(i),t.d(i,{OrganizationProfile:function(){return re},OrganizationProfileModal:function(){return le}});var a=t(2903),o=t(2784),n=t(5480),r=t(8173),l=t(3476),s=t(8690),d=t(3736),c=t(2609),u=t(3185),g=t(1609),m=t(1659);const v=e=>{const i=(0,s.useCardState)(),{navigateAfterLeaveOrganization:t}=(0,r.useOrganizationProfileContext)(),{userMemberships:a,userInvitations:o}=(0,r.useCoreOrganizationList)({userMemberships:m.AO.userMemberships,userInvitations:m.AO.userInvitations});return()=>i.runAsync((async()=>{await(null==e?void 0:e())})).then((()=>{var e,i;null===(e=a.revalidate)||void 0===e||e.call(a),null===(i=o.revalidate)||void 0===i||i.call(o),t()}))},h=()=>{const{organization:e}=(0,r.useCoreOrganization)(),i=(0,r.useCoreUser)(),t=v(e?()=>i.leaveOrganization(e.id):void 0);return e&&i?(0,a.tZ)(p,{organizationName:null==e?void 0:e.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.actionDescription",{organizationName:null==e?void 0:e.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.successMessage"),onConfirmation:t}):null},z=()=>{const{organization:e,membership:i}=(0,r.useCoreOrganization)(),t=v(null==e?void 0:e.destroy);return e&&i?(0,a.tZ)(p,{organizationName:null==e?void 0:e.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.actionDescription",{organizationName:null==e?void 0:e.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.successMessage"),onConfirmation:t}):null},p=(0,s.withCardStateProvider)((e=>{const{title:i,messageLine1:t,messageLine2:o,actionDescription:r,organizationName:u,successMessage:m,submitLabel:v,onConfirmation:h,colorScheme:z="danger"}=e,p=(0,n.a2)(),f=(0,s.useCardState)(),{navigate:b}=(0,d.useRouter)(),P=(0,g.Yp)("deleteOrganizationConfirmation","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__confirmDeletion"),isRequired:!0,placeholder:u}),y=!r||P.value===u;return(0,a.BX)(n.en,{...p.props,children:[(0,a.tZ)(s.ContentPage,{headerTitle:i,breadcrumbTitle:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.title"),Breadcrumbs:c.G,children:(0,a.BX)(s.Form.Root,{onSubmit:async()=>{if(y)try{await h().then((()=>p.nextStep()))}catch(e){(0,g.S3)(e,[],f.setError)}},children:[(0,a.tZ)(l.Text,{localizationKey:t}),(0,a.tZ)(l.Text,{localizationKey:o}),(0,a.tZ)(l.Text,{localizationKey:r}),(0,a.tZ)(s.Form.ControlRow,{elementId:P.id,children:(0,a.tZ)(s.Form.Control,{...P.props,required:!0})}),(0,a.BX)(s.FormButtonContainer,{children:[(0,a.tZ)(s.Form.SubmitButton,{block:!1,colorScheme:z,localizationKey:v,isDisabled:!y}),(0,a.tZ)(s.Form.ResetButton,{localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:async()=>{await b("..")}})]})]})}),(0,a.tZ)(s.SuccessPage,{title:i,text:m})]})})),f=(0,s.withCardStateProvider)((()=>{const{organizationSettings:e}=(0,r.useEnvironment)(),i=(0,l.localizationKeys)("organizationProfile.createDomainPage.title"),t=(0,l.localizationKeys)("organizationProfile.createDomainPage.subtitle"),o=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),n=(0,s.useCardState)(),{organization:u}=(0,r.useCoreOrganization)(),{navigate:m}=(0,d.useRouter)(),v=(0,g.Yp)("name","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomain"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomain")});if(!u||!e)return null;const h=""!==v.value.trim();return(0,a.tZ)(s.ContentPage,{headerTitle:i,headerSubtitle:t,breadcrumbTitle:o,Breadcrumbs:c.G,children:(0,a.BX)(s.Form.Root,{onSubmit:e=>(v.setError(void 0),e.preventDefault(),u.createDomain(v.value).then((e=>e.verification&&"verified"===e.verification.status?m(`../domain/${e.id}?mode=select`):m(`../domain/${e.id}/verify`))).catch((e=>{(0,g.S3)(e,[v],n.setError)}))),children:[(0,a.tZ)(s.Form.ControlRow,{elementId:v.id,children:(0,a.tZ)(s.Form.Control,{...v.props,autoFocus:!0,required:!0})}),(0,a.tZ)(s.FormButtons,{isDisabled:!h})]})})}));var b=t(2848),P=t(9813),y=t(5802),Z=t(9654);const S={memberships:{pageSize:10,keepPreviousData:!0}},_=()=>{const e=(0,s.useCardState)(),{organization:i,memberships:t}=(0,r.useCoreOrganization)(S),{options:o,isLoading:n}=(0,y.e)();if(!i)return null;const d=i=>async()=>e.runAsync((async()=>{var e;const a=await i.destroy();return await(null===(e=null==t?void 0:t.revalidate)||void 0===e?void 0:e.call(t)),a})).catch((i=>(0,g.S3)(i,[],e.setError)));return(0,a.tZ)(Z.wQ,{page:(null==t?void 0:t.page)||1,onPageChange:e=>{var i;return null===(i=null==t?void 0:t.fetchPage)||void 0===i?void 0:i.call(t,e)},itemCount:(null==t?void 0:t.count)||0,pageCount:(null==t?void 0:t.pageCount)||0,itemsPerPage:S.memberships.pageSize,isLoading:(null==t?void 0:t.isLoading)||n,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.detailsTitle__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__joined"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==t?void 0:t.data)||[]).map((i=>{return(0,a.tZ)(C,{membership:i,options:o,onRoleChange:(t=i,i=>e.runAsync((async()=>await t.update({role:i}))).catch((i=>(0,g.S3)(i,[],e.setError)))),onRemove:d(i)},i.id);var t}))})},C=e=>{var i;const{membership:t,onRemove:o,onRoleChange:n,options:d}=e,{localizeCustomRole:c}=(0,y.q)(),u=(0,s.useCardState)(),g=(0,r.useCoreUser)().id===t.publicUserData.userId,m=null===(i=null==d?void 0:d.find((e=>e.value===t.role)))||void 0===i?void 0:i.label;return(0,a.BX)(Z.RN,{children:[(0,a.tZ)(l.Td,{children:(0,a.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},user:t.publicUserData,subtitle:t.publicUserData.identifier,badge:g&&(0,a.tZ)(l.Badge,{textVariant:"extraSmallMedium",localizationKey:(0,l.localizationKeys)("badge__you")})})}),(0,a.tZ)(l.Td,{children:t.createdAt.toLocaleDateString()}),(0,a.tZ)(l.Td,{children:(0,a.tZ)(P.Cc,{permission:"org:sys_memberships:manage",fallback:(0,a.tZ)(l.Text,{sx:e=>({opacity:e.opacity.$inactive}),children:c(t.role)||m}),children:(0,a.tZ)(Z.DQ,{isDisabled:u.isLoading||!n,value:t.role,onChange:n,roles:d})})}),(0,a.tZ)(l.Td,{children:(0,a.tZ)(P.Cc,{permission:"org:sys_memberships:manage",children:(0,a.tZ)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.menuAction__remove"),isDestructive:!0,onClick:o,isDisabled:g}],elementId:"member"})})})]})};var x=t(996);const K=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{__unstable_manageBillingUrl:i,__unstable_manageBillingLabel:t,__unstable_manageBillingMembersLimit:o}=(0,r.useOrganizationProfileContext)(),n=(0,d.useRouter)();if(!e)return null;const s=(null==e?void 0:e.membersCount)+(null==e?void 0:e.pendingInvitationsCount);return(0,a.BX)(l.Flex,{sx:e=>({background:e.colors.$blackAlpha50,padding:e.space.$4,justifyContent:"space-between",alignItems:"flex-start",borderRadius:e.radii.$md}),children:[(0,a.BX)(l.Col,{children:[(0,a.tZ)(l.Text,{sx:e=>({lineHeight:e.lineHeights.$tall}),children:"Members can be given access to applications."}),(0,x.OR)(o)>0&&(0,a.tZ)(l.Link,{variant:"regularRegular",sx:e=>({alignSelf:"flex-start",color:e.colors.$primary500,marginTop:e.space.$1,fontWeight:e.fontWeights.$normal}),onClick:()=>n.navigate((0,x.OR)(i)),children:(0,x.OR)(t)||"Manage billing"})]}),(0,a.tZ)(l.Col,{children:(0,a.BX)(l.Text,{variant:"regularRegular",sx:e=>({fontWeight:e.fontWeights.$normal,lineHeight:e.lineHeights.$tall,color:e.colors.$blackAlpha600}),children:[s," of"," ",o?`${(0,x.OR)(o)} members`:"unlimited"]})})]})};var T=t(4804),B=t(8441);const D={manual_invitation:(0,l.localizationKeys)("organizationProfile.badge__manualInvitation"),automatic_invitation:(0,l.localizationKeys)("organizationProfile.badge__automaticInvitation"),automatic_suggestion:(0,l.localizationKeys)("organizationProfile.badge__automaticSuggestion")},R=e=>{const{organizationDomain:i}=e;return i?i.verification&&"verified"===i.verification.status?(0,a.tZ)(l.Badge,{localizationKey:D[i.enrollmentMode],colorScheme:"manual_invitation"===i.enrollmentMode?"neutral":"primary",textVariant:"extraSmallMedium"}):(0,a.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("organizationProfile.badge__unverified"),textVariant:"extraSmallMedium",colorScheme:"danger"}):null},w=(e,i,t)=>(0,x.Xn)((0,x.M)((0,x.ju)(`${e}/${i}/${t||""}`))),L=({redirectSubPath:e,domainId:i})=>{const t=((e,i)=>{const{isAuthorizedUser:t}=(0,n.DD)({permission:"org:sys_domains:manage"}),{navigate:a}=(0,d.useRouter)(),o=[];return t&&(o.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.unverifiedDomain_menuAction__verify"),onClick:()=>a(w(e,i,"verify"))}),o.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.unverifiedDomain_menuAction__remove"),isDestructive:!0,onClick:()=>a(w(e,i,"remove"))})),o})(e,i);return(0,a.tZ)(s.ThreeDotsMenu,{actions:t})},F=(0,n.rh)((e=>{const{verificationStatus:i,enrollmentMode:t,redirectSubPath:c,fallback:u,...g}=e,{organization:m,domains:v}=(0,r.useCoreOrganization)({domains:{infinite:!0,...g}}),{isAuthorizedUser:h}=(0,n.DD)({permission:"org:sys_domains:manage"}),{ref:z}=(0,B.YD)({threshold:0,onChange:e=>{var i;e&&(null===(i=null==v?void 0:v.fetchNext)||void 0===i||i.call(v))}}),{navigate:p}=(0,d.useRouter)(),{pathToDomainPage:f}=(0,r.useOrganizationProfileContext)(),b=(0,o.useMemo)((()=>(null==v?void 0:v.data)?v.data.filter((e=>{let a=!0,o=!0;return i&&(a=!!e.verification&&e.verification.status===i),t&&(o=e.enrollmentMode===t),a&&o})):[]),[null==v?void 0:v.data]);return m?(0,a.BX)(l.Col,{children:[0===b.length&&!(null==v?void 0:v.isLoading)&&u,b.map((e=>e.verification&&"verified"===e.verification.status&&h?(0,a.tZ)(s.ArrowBlockButton,{variant:"ghost",colorScheme:"neutral",badge:i?void 0:(0,a.tZ)(R,{organizationDomain:e}),sx:e=>({padding:`${e.space.$3} ${e.space.$4}`,minHeight:e.sizes.$10}),onClick:()=>p("domain"===c?(0,x.Xn)((0,x.M)((0,x.ju)(`domain/${e.id}`))):(0,x.Xn)(`${f}/${e.id}`)),children:e.name},e.id):(0,a.tZ)(s.BlockWithTrailingComponent,{sx:e=>({"&:hover":{backgroundColor:e.colors.$blackAlpha50},padding:`${e.space.$none} ${e.space.$4}`,minHeight:e.sizes.$10}),badge:(0,a.tZ)(R,{organizationDomain:e}),trailingComponent:h?(0,a.tZ)(L,{redirectSubPath:c,domainId:e.id}):void 0,children:e.name},e.id))),((null==v?void 0:v.hasNextPage)||(null==v?void 0:v.isFetching))&&(0,a.tZ)(l.Box,{ref:(null==v?void 0:v.isFetching)?void 0:z,sx:[e=>({width:"100%",height:e.space.$10,position:"relative"})],children:(0,a.tZ)(l.Box,{sx:{display:"flex",margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,a.tZ)(l.Spinner,{size:"sm",colorScheme:"primary"})})})]}):null}),{permission:"org:sys_domains:read"}),M={invitations:{pageSize:10,keepPreviousData:!0}},k=()=>{const e=(0,s.useCardState)(),{organization:i,invitations:t}=(0,r.useCoreOrganization)(M),{options:o,isLoading:n}=(0,y.e)();return i?(0,a.tZ)(Z.wQ,{page:(null==t?void 0:t.page)||1,onPageChange:(null==t?void 0:t.fetchPage)||(()=>null),itemCount:(null==t?void 0:t.count)||0,pageCount:(null==t?void 0:t.pageCount)||0,itemsPerPage:M.invitations.pageSize,isLoading:(null==t?void 0:t.isLoading)||n,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.tableHeader__invited"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==t?void 0:t.data)||[]).map((i=>{return(0,a.tZ)(O,{options:o,invitation:i,onRevoke:(n=i,async()=>e.runAsync((async()=>{var e;return await n.revoke(),await(null===(e=null==t?void 0:t.revalidate)||void 0===e?void 0:e.call(t)),n})).catch((i=>(0,g.S3)(i,[],e.setError))))},i.id);var n}))}):null},O=e=>{var i;const{invitation:t,onRevoke:o,options:n}=e,{localizeCustomRole:r}=(0,y.q)(),d=null===(i=null==n?void 0:n.find((e=>e.value===t.role)))||void 0===i?void 0:i.label;return(0,a.BX)(Z.RN,{children:[(0,a.tZ)(l.Td,{children:(0,a.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},user:{primaryEmailAddress:{emailAddress:t.emailAddress}}})}),(0,a.tZ)(l.Td,{children:t.createdAt.toLocaleDateString()}),(0,a.tZ)(l.Td,{children:(0,a.tZ)(l.Text,{colorScheme:"neutral",localizationKey:r(t.role)||d})}),(0,a.tZ)(l.Td,{children:(0,a.tZ)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.menuAction__revoke"),isDestructive:!0,onClick:o}],elementId:"invitation"})})]})},$=()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),{navigate:t}=(0,d.useRouter)(),{__unstable_manageBillingUrl:o,navigateToAddDomainPage:c}=(0,r.useOrganizationProfileContext)(),u=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled;return(0,a.BX)(l.Col,{gap:8,sx:{width:"100%"},children:[o&&(0,a.tZ)(K,{}),u&&(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",children:(0,a.BX)(l.Col,{gap:2,sx:{width:"100%"},children:[(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerTitle"),textVariant:"largeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerSubtitle"),variant:"regularRegular"})]}),(0,a.tZ)(F,{fallback:(0,a.tZ)(n.of,{colorScheme:"primary",textLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.primaryButton"),id:"manageVerifiedDomains",onClick:c}),redirectSubPath:"organization-settings/domain",verificationStatus:"verified",enrollmentMode:"automatic_invitation"})]})}),(0,a.BX)(l.Flex,{direction:"col",gap:4,sx:{width:"100%"},children:[(0,a.BX)(l.Flex,{justify:"between",align:"center",children:[(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.manualInvitations.headerTitle"),textVariant:"largeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.manualInvitations.headerSubtitle"),variant:"regularRegular"})]}),(0,a.tZ)(s.IconButton,{elementDescriptor:l.descriptors.membersPageInviteButton,"aria-label":"Invite",onClick:()=>t("invite-members"),icon:(0,a.tZ)(l.Icon,{icon:T.av,size:"sm",sx:e=>({marginRight:e.space.$2})}),textVariant:"buttonExtraSmallBold",localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.action__invite")})]}),(0,a.tZ)(k,{})]})]})},X={membershipRequests:{pageSize:10,keepPreviousData:!0}},I=()=>{var e;const i=(0,s.useCardState)(),{organization:t,membershipRequests:o}=(0,r.useCoreOrganization)(X);return t?(0,a.tZ)(Z.wQ,{page:(null==o?void 0:o.page)||1,onPageChange:null!==(e=null==o?void 0:o.fetchPage)&&void 0!==e?e:()=>null,itemCount:(null==o?void 0:o.count)||0,pageCount:(null==o?void 0:o.pageCount)||0,itemsPerPage:X.membershipRequests.pageSize,isLoading:null==o?void 0:o.isLoading,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.tableHeader__requested"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==o?void 0:o.data)||[]).map((e=>(0,a.tZ)(A,{request:e,onError:i.setError},e.id)))}):null},A=(0,s.withCardStateProvider)((e=>{const{request:i,onError:t}=e,o=(0,s.useCardState)(),{membership:n,membershipRequests:d}=(0,r.useCoreOrganization)(X);return(0,a.BX)(Z.RN,{children:[(0,a.tZ)(l.Td,{children:(0,a.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},showAvatar:!1,user:{primaryEmailAddress:{emailAddress:i.publicUserData.identifier}}})}),(0,a.tZ)(l.Td,{children:i.createdAt.toLocaleDateString()}),(0,a.tZ)(l.Td,{children:(0,a.tZ)(E,{onAccept:()=>{if(n&&d)return o.runAsync((async()=>{await i.accept(),await d.revalidate()}),"accept").catch((e=>(0,g.S3)(e,[],t)))},onReject:()=>{if(n&&d)return o.runAsync((async()=>{await i.reject(),await d.revalidate()}),"reject").catch((e=>(0,g.S3)(e,[],t)))}})})]})})),E=e=>{const i=(0,s.useCardState)();return(0,a.BX)(l.Flex,{gap:2,children:[(0,a.tZ)(l.Button,{textVariant:"buttonExtraSmallBold",variant:"ghost",isLoading:i.isLoading&&"reject"===i.loadingMetadata,isDisabled:i.isLoading&&"reject"!==i.loadingMetadata,onClick:e.onReject,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__reject")}),(0,a.tZ)(l.Button,{textVariant:"buttonExtraSmallBold",variant:"solid",isLoading:i.isLoading&&"accept"===i.loadingMetadata,isDisabled:i.isLoading&&"accept"!==i.loadingMetadata,onClick:e.onAccept,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__approve")})]})},H=()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),{__unstable_manageBillingUrl:t,navigateToAddDomainPage:o}=(0,r.useOrganizationProfileContext)(),d=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled;return(0,a.BX)(l.Col,{gap:8,sx:{width:"100%"},children:[t&&(0,a.tZ)(K,{}),d&&(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",children:(0,a.BX)(l.Col,{gap:2,sx:{width:"100%"},children:[(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerTitle"),textVariant:"largeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerSubtitle"),variant:"regularRegular"})]}),(0,a.tZ)(F,{fallback:(0,a.tZ)(n.of,{colorScheme:"primary",textLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.primaryButton"),id:"manageVerifiedDomains",onClick:o}),redirectSubPath:"organization-settings/domain",verificationStatus:"verified",enrollmentMode:"automatic_suggestion"})]})}),(0,a.BX)(l.Flex,{direction:"col",gap:4,sx:{width:"100%"},children:[(0,a.tZ)(l.Flex,{justify:"between",align:"center",children:(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.requests.headerTitle"),textVariant:"largeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.requests.headerSubtitle"),variant:"regularRegular"})]})}),(0,a.tZ)(I,{})]})]})},q=(0,s.withCardStateProvider)((()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),t=(0,s.useCardState)(),{isAuthorizedUser:o}=(0,n.DD)({permission:"org:sys_memberships:manage"}),{isAuthorizedUser:d}=(0,n.DD)({permission:"org:sys_memberships:read"}),c=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled,{membershipRequests:u}=(0,r.useCoreOrganization)({membershipRequests:c||void 0}),{__unstable_manageBillingUrl:g}=(0,r.useOrganizationProfileContext)();return null===o?null:(0,a.BX)(l.Col,{elementDescriptor:l.descriptors.page,gap:8,children:[(0,a.tZ)(s.CardAlert,{children:t.error}),(0,a.tZ)(s.NavbarMenuButtonRow,{}),(0,a.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationMembers"),gap:8,children:[(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__members"),textVariant:"xxlargeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerSubtitle__members")})]}),(0,a.BX)(s.Tabs,{children:[(0,a.BX)(s.TabsList,{children:[d&&(0,a.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__members")}),o&&(0,a.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__invitations")}),o&&c&&(0,a.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__requests"),children:(0,a.tZ)(n.dN,{notificationCount:(null==u?void 0:u.count)||0})})]}),(0,a.BX)(s.TabPanels,{children:[d&&(0,a.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,a.BX)(l.Flex,{gap:4,direction:"col",sx:{width:"100%"},children:[o&&g&&(0,a.tZ)(K,{}),(0,a.tZ)(_,{})]})}),o&&(0,a.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,a.tZ)($,{})}),o&&c&&(0,a.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,a.tZ)(H,{})})]})]})]})]})})),U=()=>(0,a.BX)(l.Col,{elementDescriptor:l.descriptors.page,gap:8,children:[(0,a.tZ)(s.NavbarMenuButtonRow,{}),(0,a.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationSettings"),gap:8,children:[(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__settings"),textVariant:"xxlargeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerSubtitle__settings")})]}),(0,a.tZ)(N,{}),(0,a.tZ)(n.Cc,{permission:"org:sys_domains:read",children:(0,a.tZ)(V,{})}),(0,a.tZ)(j,{})]})]}),N=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{navigate:i}=(0,d.useRouter)();if(!e)return null;const t=(0,a.tZ)(s.OrganizationPreview,{organization:e,size:"lg"});return(0,a.tZ)(s.ProfileSection,{title:(0,l.localizationKeys)("organizationProfile.profilePage.title"),id:"organizationProfile",children:(0,a.tZ)(n.Cc,{permission:"org:sys_profile:manage",fallback:(0,a.tZ)(a.HY,{children:t}),children:(0,a.tZ)(n.of,{onClick:()=>i("profile"),children:t})})})},V=()=>{const{organizationSettings:e}=(0,r.useEnvironment)(),{organization:i}=(0,r.useCoreOrganization)(),{navigate:t}=(0,d.useRouter)();return e&&i&&e.domains.enabled?(0,a.BX)(s.ProfileSection,{title:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),subtitle:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.subtitle"),id:"organizationDomains",children:[(0,a.tZ)(F,{redirectSubPath:"domain"}),(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",children:(0,a.tZ)(n.Br,{textLocalizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.primaryButton"),id:"addOrganizationDomain",onClick:()=>t("domain")})})]}):null},j=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{navigate:i}=(0,d.useRouter)(),{isAuthorizedUser:t}=(0,n.DD)({permission:"org:sys_profile:delete"});if(!e)return null;const o=e.adminDeleteEnabled;return(0,a.tZ)(s.ProfileSection,{id:"organizationDanger",title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.title"),sx:e=>({marginBottom:e.space.$4}),children:(0,a.BX)(l.Flex,{gap:4,children:[(0,a.tZ)(s.IconButton,{"aria-label":"Leave organization",icon:(0,a.tZ)(l.Icon,{icon:T.um,size:"sm",sx:e=>({marginRight:e.space.$2})}),variant:"outline",colorScheme:"danger",textVariant:"buttonExtraSmallBold",onClick:()=>i("leave"),localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title")}),t&&o&&(0,a.tZ)(s.IconButton,{"aria-label":"Delete organization",icon:(0,a.tZ)(l.Icon,{icon:T.um,size:"sm",sx:e=>({marginRight:e.space.$2})}),variant:"outline",colorScheme:"danger",textVariant:"buttonExtraSmallBold",onClick:()=>i("delete"),localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title")})]})})};var W=t(6884);const G=(0,s.withCardStateProvider)((()=>{const e=(0,l.localizationKeys)("organizationProfile.profilePage.title"),i=(0,l.localizationKeys)("organizationProfile.profilePage.subtitle"),t=(0,s.useCardState)(),[d,u]=o.useState(!1),{organization:m}=(0,r.useCoreOrganization)(),v=(0,n.a2)({onNextStep:()=>t.setError(void 0)}),h=(0,g.Yp)("name",(null==m?void 0:m.name)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationName"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationName")}),z=(0,g.Yp)("slug",(null==m?void 0:m.slug)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationSlug"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationSlug")});if(!m)return null;const p=(m.name!==h.value||m.slug!==z.value||d)&&"error"!==z.feedbackType;return(0,a.BX)(n.en,{...v.props,children:[(0,a.tZ)(s.ContentPage,{headerTitle:e,headerSubtitle:i,Breadcrumbs:c.G,children:(0,a.BX)(s.Form.Root,{onSubmit:async e=>(e.preventDefault(),(p?m.update({name:h.value,slug:z.value}):Promise.resolve()).then(v.nextStep).catch((e=>{(0,g.S3)(e,[h,z],t.setError)}))),children:[(0,a.tZ)(W.D,{organization:m,onAvatarChange:e=>m.setLogo({file:e}).then((()=>{u(!0),t.setIdle()})).catch((e=>(0,g.S3)(e,[],t.setError))),onAvatarRemove:(0,x.QO)(m.imageUrl)?null:()=>{m.setLogo({file:null}).then((()=>{u(!0),t.setIdle()})).catch((e=>(0,g.S3)(e,[],t.setError)))}}),(0,a.tZ)(s.Form.ControlRow,{elementId:h.id,children:(0,a.tZ)(s.Form.Control,{...h.props,autoFocus:!0,required:!0})}),(0,a.tZ)(s.Form.ControlRow,{elementId:z.id,children:(0,a.tZ)(s.Form.Control,{...z.props,onChange:e=>{var i;i=e.target.value,z.setValue(i),z.setError(void 0)},required:!0})}),(0,a.tZ)(s.FormButtons,{isDisabled:!p})]})}),(0,a.tZ)(s.SuccessPage,{title:e,text:(0,l.localizationKeys)("organizationProfile.profilePage.successMessage"),Breadcrumbs:c.G})]})}));var Y=t(4334);const Q=()=>{var e,i;const{organizationSettings:t}=(0,r.useEnvironment)(),{organization:s}=(0,r.useCoreOrganization)(),{params:u}=(0,d.useRouter)(),g=o.useRef(),{data:m,isLoading:v}=(0,B.ib)(null==s?void 0:s.getDomain,{domainId:u.id},{onSuccess(e){g.current={...e}}}),{domains:h}=(0,r.useCoreOrganization)({domains:{infinite:!0}});return s&&t?v||!m?(0,a.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,a.tZ)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(0,a.tZ)(n.hH,{title:(0,Y.u1)("organizationProfile.removeDomainPage.title"),messageLine1:(0,Y.u1)("organizationProfile.removeDomainPage.messageLine1",{domain:null===(e=g.current)||void 0===e?void 0:e.name}),messageLine2:(0,Y.u1)("organizationProfile.removeDomainPage.messageLine2"),successMessage:(0,Y.u1)("organizationProfile.removeDomainPage.successMessage",{domain:null===(i=g.current)||void 0===i?void 0:i.name}),deleteResource:()=>null==m?void 0:m.delete().then((()=>{var e;return null===(e=null==h?void 0:h.revalidate)||void 0===e?void 0:e.call(h)})),breadcrumbTitle:(0,Y.u1)("organizationProfile.profilePage.domainSection.title"),Breadcrumbs:c.G}):null};var J=t(869);const ee=(e,{infoLabel:i})=>{const t=(null==e?void 0:e.totalPendingInvitations)||0;return 0===((null==e?void 0:e.totalPendingSuggestions)||0)+t?[]:[i,(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInvitationCountLabel",{count:t}),(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutSuggestionCountLabel",{count:t})]},ie=(0,s.withCardStateProvider)((()=>{const e=(0,s.useCardState)(),{organizationSettings:i}=(0,r.useEnvironment)(),{membership:t,organization:o,domains:u}=(0,r.useCoreOrganization)({domains:{infinite:!0}}),{isAuthorizedUser:m}=(0,n.DD)({permission:"org:sys_domains:manage"}),{navigateToFlowStart:v}=(0,B.zk)(),{params:h,navigate:z,queryParams:p}=(0,d.useRouter)(),f=p.mode||"edit",b=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),P="edit"===f,y=(0,g.Yp)("enrollmentMode","",{type:"radio",radioOptions:[...i.domains.enrollmentModes.includes("manual_invitation")?[{value:"manual_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__description")}]:[],...i.domains.enrollmentModes.includes("automatic_invitation")?[{value:"automatic_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__description")}]:[],...i.domains.enrollmentModes.includes("automatic_suggestion")?[{value:"automatic_suggestion",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__description")}]:[]]}),Z=(0,g.Yp)("deleteExistingInvitationsSuggestions","",{label:(0,l.localizationKeys)("formFieldLabel__organizationDomainDeletePending"),type:"checkbox"}),{data:S,isLoading:_}=(0,B.ib)(null==o?void 0:o.getDomain,{domainId:h.id},{onSuccess(e){y.setValue(e.enrollmentMode)}}),C=Z.checked||(null==S?void 0:S.enrollmentMode)!==y.value,x=(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.subtitle",{domain:null==S?void 0:S.name}),K=ee(S,{infoLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInfoLabel")}),D=ee(S,{infoLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.calloutInfoLabel")});return o&&i?_||!S?(0,a.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,a.tZ)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(S.verification&&"verified"===S.verification.status||v(),(0,a.tZ)(s.ContentPage,{headerTitle:S.name,headerSubtitle:P?void 0:x,breadcrumbTitle:b,gap:4,Breadcrumbs:c.G,children:(0,a.tZ)(l.Col,{gap:6,children:(0,a.BX)(s.Tabs,{children:[(0,a.BX)(s.TabsList,{children:[m&&(0,a.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.start.headerTitle__enrollment")}),P&&m&&(0,a.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.start.headerTitle__danger")})]}),(0,a.BX)(s.TabPanels,{children:[m&&(0,a.BX)(s.TabPanel,{sx:{width:"100%"},direction:"col",gap:4,children:[K.length>0&&(0,a.tZ)(n.aX,{icon:T.I$,children:K.map(((e,i)=>(0,a.tZ)(l.Text,{as:"span",sx:[e=>({lineHeight:e.lineHeights.$short,color:"inherit",display:"block"})],localizationKey:e},i)))}),(0,a.tZ)(s.Header.Root,{children:(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.subtitle"),variant:"regularRegular"})}),(0,a.BX)(s.Form.Root,{onSubmit:async()=>{if(S&&o&&t&&u)try{await S.updateEnrollmentMode({enrollmentMode:y.value,deletePending:Z.checked}),await u.revalidate(),await z("../../")}catch(i){(0,g.S3)(i,[y],e.setError)}},gap:6,children:[(0,a.tZ)(s.Form.ControlRow,{elementId:y.id,children:(0,a.tZ)(s.Form.Control,{...y.props})}),P&&(0,a.tZ)(s.Form.ControlRow,{elementId:Z.id,children:(0,a.tZ)(s.Form.Control,{...Z.props})}),(0,a.tZ)(s.FormButtons,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.formButton__save"),isDisabled:_||!S||!C})]})]}),P&&m&&(0,a.BX)(s.TabPanel,{direction:"col",gap:4,sx:{width:"100%"},children:[D.length>0&&(0,a.tZ)(n.aX,{icon:T.I$,children:D.map(((e,i)=>(0,a.tZ)(l.Text,{as:"span",sx:[e=>({lineHeight:e.lineHeights.$short,color:"inherit",display:"block"})],localizationKey:e},i)))}),(0,a.tZ)(l.Col,{sx:e=>({padding:`${e.space.$none} ${e.space.$4}`}),children:(0,a.tZ)(J.f,{title:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainTitle"),subtitle:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainSubtitle"),actionLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainActionLabel__remove"),colorScheme:"danger",onClick:()=>z(`../../domain/${S.id}/remove`)})})]})]})]})})})):null}));var te=t(6684);const ae=(0,s.withCardStateProvider)((()=>{var e;const i=(0,s.useCardState)(),{organizationSettings:t}=(0,r.useEnvironment)(),{organization:u}=(0,r.useCoreOrganization)(),{params:m,navigate:v}=(0,d.useRouter)(),[h,z]=o.useState(!1),{data:p,isLoading:f}=(0,B.ib)(null==u?void 0:u.getDomain,{domainId:m.id}),b=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.title"),P=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitle",{domainName:null!==(e=null==p?void 0:p.name)&&void 0!==e?e:""}),y=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),Z=(0,B._m)(),S=(0,g.Yp)("code",""),_=(0,s.useCodeControl)(S),C=(0,n.a2)({onNextStep:()=>i.setError(void 0)}),x=(0,g.Yp)("affiliationEmailAddress","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddress"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomainEmailAddress"),infoText:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddressDescription")}),K=(0,o.useRef)(),T=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitleVerificationCodeScreen",{emailAddress:K.current}),D=async()=>{z(!0),await(0,g._v)(750)},R=async e=>{(0,g.S3)(e,[S],i.setError),Z.setIdle(),await(0,g._v)(750),_.reset()};if(_.onCodeEntryFinished((e=>{Z.setLoading(),S.setError(void 0),((e,i,t)=>{var a;null===(a=null==p?void 0:p.attemptAffiliationVerification)||void 0===a||a.call(p,{code:e}).then((async e=>{var t;if(await i(),"verified"===(null===(t=e.verification)||void 0===t?void 0:t.status))return v(`../../../domain/${e.id}?mode=select`)})).catch((e=>t(e)))})(e,D,R)})),!u||!t)return null;const w=u.name!==x.value,L=`@${null==p?void 0:p.name}`;return f||!p?(0,a.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,a.tZ)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(0,a.BX)(n.en,{...C.props,children:[(0,a.tZ)(s.ContentPage,{headerTitle:b,breadcrumbTitle:y,headerSubtitle:P,Breadcrumbs:c.G,children:(0,a.BX)(s.Form.Root,{onSubmit:e=>{if(e.preventDefault(),p)return K.current=`${x.value}${L}`,p.prepareAffiliationVerification({affiliationEmailAddress:K.current}).then(C.nextStep).catch((e=>{(0,g.S3)(e,[x],i.setError)}))},children:[(0,a.tZ)(s.Form.ControlRow,{elementId:x.id,children:(0,a.tZ)(s.Form.Control,{...x.props,autoFocus:!0,groupSuffix:`@${p.name}`,required:!0})}),(0,a.tZ)(s.FormButtons,{isDisabled:!w})]})}),(0,a.BX)(s.ContentPage,{headerTitle:b,breadcrumbTitle:y,headerSubtitle:T,Breadcrumbs:c.G,children:[(0,a.tZ)(te.T,{title:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formTitle"),subtitle:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formSubtitle"),resendButton:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.resendButton"),isLoading:Z.isLoading,success:h,codeControl:_,onResendCodeClicked:()=>{_.reset(),null==p||p.prepareAffiliationVerification({affiliationEmailAddress:x.value}).catch((e=>{(0,g.S3)(e,[x],i.setError)}))}}),(0,a.tZ)(s.FormButtonContainer,{children:(0,a.tZ)(l.Button,{elementDescriptor:l.descriptors.formButtonReset,block:!1,variant:"ghost",textVariant:"buttonExtraSmallBold",type:"reset",isDisabled:Z.isLoading||h,onClick:()=>{S.clearFeedback(),_.reset(),C.prevStep()},localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset")})})]})]})})),oe=e=>{var i;const{pages:t,isMembersPageRoot:o,isSettingsPageRoot:l}=(0,r.useOrganizationProfileContext)(),c=null===(i=t.contents)||void 0===i?void 0:i.map(((e,i)=>{const t=!l&&!o&&0===i;return(0,a.tZ)(d.Route,{index:t,path:t?void 0:e.url,children:(0,a.tZ)(u.O,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)}));return(0,a.tZ)(s.ProfileCardContent,{contentRef:e.contentRef,children:(0,a.BX)(d.Switch,{children:[c,(0,a.BX)(d.Route,{children:[(0,a.tZ)(d.Route,{path:l?void 0:"organization-settings",children:(0,a.BX)(d.Switch,{children:[(0,a.tZ)(d.Route,{path:"profile",flowStart:!0,children:(0,a.tZ)(n.Cc,{permission:"org:sys_profile:manage",redirectTo:"../",children:(0,a.tZ)(G,{})})}),(0,a.tZ)(d.Route,{path:"domain",flowStart:!0,children:(0,a.BX)(d.Switch,{children:[(0,a.tZ)(d.Route,{path:":id/verify",children:(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",redirectTo:"../../",children:(0,a.tZ)(ae,{})})}),(0,a.tZ)(d.Route,{path:":id/remove",children:(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",redirectTo:"../../",children:(0,a.tZ)(Q,{})})}),(0,a.tZ)(d.Route,{path:":id",children:(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",redirectTo:"../../",children:(0,a.tZ)(ie,{})})}),(0,a.tZ)(d.Route,{index:!0,children:(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",redirectTo:"../",children:(0,a.tZ)(f,{})})})]})}),(0,a.tZ)(d.Route,{path:"leave",flowStart:!0,children:(0,a.tZ)(h,{})}),(0,a.tZ)(d.Route,{path:"delete",flowStart:!0,children:(0,a.tZ)(n.Cc,{permission:"org:sys_profile:delete",redirectTo:"../",children:(0,a.tZ)(z,{})})}),(0,a.tZ)(d.Route,{index:!0,children:(0,a.tZ)(U,{})})]})}),(0,a.tZ)(d.Route,{path:o?void 0:"organization-members",children:(0,a.BX)(d.Switch,{children:[(0,a.tZ)(d.Route,{path:"invite-members",flowStart:!0,children:(0,a.tZ)(n.Cc,{permission:"org:sys_memberships:manage",redirectTo:"../",children:(0,a.tZ)(b.F,{})})}),(0,a.tZ)(d.Route,{index:!0,children:(0,a.tZ)(n.Cc,{condition:e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"}),redirectTo:l?"../":"./organization-settings",children:(0,a.tZ)(q,{})})})]})})]})]})})},ne=(0,r.withCoreUserGuard)((()=>{const e=o.useRef(null);return(0,a.tZ)(s.ProfileCard,{sx:{height:"100%"},children:(0,a.tZ)(c.M,{contentRef:e,children:(0,a.tZ)(oe,{contentRef:e})})})})),re=(0,n.Q6)((0,n.pK)((0,s.withCardStateProvider)((e=>{const{organization:i}=(0,r.useCoreOrganization)();return i?(0,a.tZ)(l.Flow.Root,{flow:"organizationProfile",children:(0,a.tZ)(l.Flow.Part,{children:(0,a.tZ)(d.Switch,{children:(0,a.tZ)(d.Route,{children:(0,a.tZ)(ne,{})})})})}):null})),"OrganizationProfile",{mode:"redirect"})),le=e=>{const i={...e,routing:"virtual",componentName:"OrganizationProfile",mode:"modal"};return(0,a.tZ)(d.Route,{path:"organizationProfile",children:(0,a.tZ)(r.ComponentContext.Provider,{value:i,children:(0,a.tZ)("div",{children:(0,a.tZ)(re,{...i})})})})}},1659:function(e,i,t){t.d(i,{$o:function(){return n},AO:function(){return a},Sz:function(){return o}});const a={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},o=(e,i)=>void 0===i?[{data:[e],total_count:1}]:i.map((i=>{if(void 0===i)return i;const t=i.data.map((i=>i.id===e.id?{...e}:i));return{...i,data:t}})),n=(e,i)=>{var t;const a=null===(t=null==i?void 0:i[i.length-1])||void 0===t?void 0:t.total_count;if(a)return null==i?void 0:i.map((i=>{if(void 0===i)return i;const t=i.data.filter((i=>i.id!==e.id));return{...i,data:t,total_count:a-1}}))}},869:function(e,i,t){t.d(i,{f:function(){return r}});var a=t(2903),o=t(3476),n=t(8441);const r=e=>{const{title:i,subtitle:t,actionLabel:r,titleLabel:l,onClick:s,...d}=e,c=(0,n._m)(),{t:u}=(0,o.useLocalizations)();return(0,a.BX)(o.Col,{gap:2,children:[(0,a.BX)(o.Col,{gap:1,children:[(0,a.BX)(o.Flex,{gap:2,align:"center",children:[(0,a.tZ)(o.Text,{localizationKey:i,variant:"regularMedium"}),l]}),(0,a.tZ)(o.Text,{localizationKey:t,variant:"smallRegular",colorScheme:"neutral"})]}),r&&(0,a.tZ)(o.Button,{localizationKey:r,loadingText:u(r),colorScheme:"primary",variant:"link",...d,isLoading:c.isLoading,onClick:e=>{var i;c.setLoading(),s&&(null===(i=null==s?void 0:s(e))||void 0===i||i.finally((()=>c.setIdle())))}})]})}}}]);