"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[971],{869:function(e,t,i){i.d(t,{f:function(){return l}});var o=i(2903),r=i(3476),a=i(8441);const l=e=>{const{title:t,subtitle:i,actionLabel:l,titleLabel:s,onClick:n,...c}=e,u=(0,a._m)(),{t:d}=(0,r.useLocalizations)();return(0,o.BX)(r.Col,{gap:2,children:[(0,o.BX)(r.Col,{gap:1,children:[(0,o.BX)(r.Flex,{gap:2,align:"center",children:[(0,o.tZ)(r.Text,{localizationKey:t,variant:"regularMedium"}),s]}),(0,o.tZ)(r.Text,{localizationKey:i,variant:"smallRegular",colorScheme:"neutral"})]}),l&&(0,o.tZ)(r.Button,{localizationKey:l,loadingText:d(l),colorScheme:"primary",variant:"link",...c,isLoading:u.isLoading,onClick:e=>{var t;u.setLoading(),n&&(null===(t=null==n?void 0:n(e))||void 0===t||t.finally((()=>u.setIdle())))}})]})}},1782:function(e,t,i){i.r(t),i.d(t,{UserProfile:function(){return Ie},UserProfileModal:function(){return Ee}});var o=i(2903),r=i(2784),a=i(5480),l=i(8173),s=i(3476),n=i(8690),c=i(3736);const u=e=>{const{pages:t}=(0,l.useUserProfileContext)();return(0,o.BX)(n.NavbarContextProvider,{children:[(0,o.tZ)(n.NavBar,{routes:t.routes,contentRef:e.contentRef}),e.children]})},d=e=>{const{pages:t}=(0,l.useUserProfileContext)();return(0,o.tZ)(n.Breadcrumbs,{...e,pageToRootNavbarRoute:t.pageToRootNavbarRouteMap})};var m=i(3185),f=i(8246),p=i(996),h=i(8441),P=i(1609);const g=(0,n.withCardStateProvider)((()=>{const e=(0,s.localizationKeys)("userProfile.connectedAccountPage.title"),t=(0,l.useCoreUser)(),{params:i}=(0,c.useRouter)(),{id:u}=i||{},m=r.useRef(t.externalAccounts.find((e=>e.id===u))),f=(0,a.a2)({defaultStep:m.current?1:0});return(0,o.BX)(a.en,{...f.props,children:[(0,o.tZ)(v,{}),(0,o.tZ)(n.SuccessPage,{title:e,text:(0,s.localizationKeys)("userProfile.connectedAccountPage.successMessage"),Breadcrumbs:d})]})})),v=()=>{const e=(0,n.useCardState)(),t=(0,l.useCoreUser)(),{navigate:i}=(0,c.useRouter)(),{strategies:r,strategyToDisplayData:a}=(0,h.vO)(),{additionalOAuthScopes:u,componentName:m,mode:f}=(0,l.useUserProfileContext)(),g="modal"===f,v=r.filter((e=>e.startsWith("oauth"))),y=t.verifiedExternalAccounts.map((e=>`oauth_${e.provider}`)),b=v.filter((e=>!y.includes(e)));return(0,o.BX)(n.ContentPage,{headerTitle:(0,s.localizationKeys)("userProfile.connectedAccountPage.title"),Breadcrumbs:d,children:[(0,o.tZ)(s.Text,{localizationKey:b.length?(0,s.localizationKeys)("userProfile.connectedAccountPage.formHint"):(0,s.localizationKeys)("userProfile.connectedAccountPage.formHint__noAccounts")}),(0,o.tZ)(s.Col,{gap:2,children:b.map((r=>(0,o.tZ)(n.ArrowBlockButton,{id:a[r].id,onClick:()=>(o=>{const r=o.replace("oauth_",""),a=g?(0,p.bX)({url:window.location.href,componentName:m,socialProvider:r}):window.location.href,l=u?u[r]:[];e.setLoading(o),t.createExternalAccount({strategy:o,redirectUrl:a,additionalScopes:l}).then((e=>{var t;(null===(t=e.verification)||void 0===t?void 0:t.externalVerificationRedirectURL)&&i(e.verification.externalVerificationRedirectURL.href)})).catch((t=>(0,P.S3)(t,[],e.setError))).finally((()=>{(0,P._v)(2e3).then((()=>e.setIdle))}))})(r),isLoading:e.loadingMetadata===r,isDisabled:e.isLoading,leftIcon:(0,o.tZ)(s.Image,{isLoading:e.loadingMetadata===r,isDisabled:e.isLoading,src:a[r].iconUrl,alt:`Connect ${a[r].name} account`,sx:e=>({width:e.sizes.$5})}),textLocalizationKey:(0,s.localizationKeys)("userProfile.connectedAccountPage.socialButtonsBlockButton",{provider:a[r].name})},r)))}),(0,o.tZ)(n.FormButtonContainer,{sx:{marginTop:0},children:(0,o.tZ)(n.NavigateToFlowStartButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset")})})]})},y=(0,n.withCardStateProvider)((()=>{const e=(0,n.useCardState)(),t=(0,l.useEnvironment)(),i=(0,c.useRouter)(),r=(0,l.useCoreUser)(),a=(0,l.useCoreClerk)(),u=(0,P.Yp)("deleteConfirmation","",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__confirmDeletion"),isRequired:!0,placeholder:"Delete account"}),m="Delete account"===u.value;return(0,o.tZ)(n.ContentPage,{headerTitle:(0,s.localizationKeys)("userProfile.deletePage.title"),Breadcrumbs:d,children:(0,o.BX)(n.Form.Root,{onSubmit:async()=>{try{await r.delete(),a.client.activeSessions.length>0?await i.navigate(t.displayConfig.afterSignOutOneUrl):await i.navigate(t.displayConfig.afterSignOutAllUrl)}catch(t){(0,P.S3)(t,[],e.setError)}},children:[(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.deletePage.messageLine1")}),(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.deletePage.messageLine2")}),(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.deletePage.actionDescription")}),(0,o.tZ)(n.Form.ControlRow,{elementId:u.id,children:(0,o.tZ)(n.Form.Control,{...u.props,required:!0})}),(0,o.tZ)(n.FormButtons,{submitLabel:(0,s.localizationKeys)("userProfile.deletePage.confirm"),colorScheme:"danger",isDisabled:!m})]})})})),b=e=>(t,i)=>e===t.id?-1:e===i.id?1:0,S=e=>e.defaultSecondFactor?-1:1;function z(e){const t=[];return Object.entries(e).forEach((([,e])=>{e.used_for_second_factor&&t.push(...e.second_factors)})),t}function Z(e,t){let i=z(e);return t.totpEnabled&&(i=i.filter((e=>"totp"!==e))),!t.backupCodeEnabled&&t.twoFactorEnabled||(i=i.filter((e=>"backup_code"!==e))),i}var C=i(6684);const K=e=>{const t=(0,n.useCardState)(),{nextStep:i,identification:a,identifier:l,prepareVerification:c}=e,[u,d]=r.useState(!1),m=(0,h._m)(),f=(0,P.Yp)("code",""),p=(0,n.useCodeControl)(f);r.useEffect((()=>{g()}),[]);const g=()=>{var e;return null===(e=null==c?void 0:c())||void 0===e?void 0:e.catch((e=>(0,P.S3)(e,[],t.setError)))},v=async e=>{(0,P.S3)(e,[f],t.setError),m.setIdle(),await(0,P._v)(750),p.reset()};return p.onCodeEntryFinished((e=>(m.setLoading(),f.setError(void 0),null==a?void 0:a.attemptVerification({code:e}).then((()=>(async()=>{d(!0),await(0,P._v)(750),i()})())).catch(v)))),(0,o.BX)(o.HY,{children:[(0,o.tZ)(C.T,{title:(0,s.localizationKeys)("userProfile.emailAddressPage.emailCode.formTitle"),subtitle:(0,s.localizationKeys)("userProfile.emailAddressPage.emailCode.formSubtitle",{identifier:l}),resendButton:(0,s.localizationKeys)("userProfile.emailAddressPage.emailCode.resendButton"),codeControl:p,isLoading:m.isLoading,success:u,onResendCodeClicked:g}),(0,o.tZ)(n.FormButtonContainer,{children:(0,o.tZ)(n.NavigateToFlowStartButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset})})]})};var B=i(6874);const _=e=>{const{email:t,nextStep:i}=e,a=(0,n.useCardState)(),c=(0,l.useUserProfileContext)(),{startEmailLinkFlow:u}=(0,h.E2)(t),{displayConfig:d}=(0,l.useEnvironment)();function m(){const{routing:e}=c,t="virtual"===e?d.userProfileUrl:"",o=(0,B.d)(c,t);u({redirectUrl:o}).then((()=>i())).catch((e=>(0,P.S3)(e,[],a.setError)))}return r.useEffect((()=>{m()}),[]),(0,o.BX)(o.HY,{children:[(0,o.tZ)(n.VerificationLink,{formTitle:(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.formTitle"),formSubtitle:(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.formSubtitle",{identifier:t.emailAddress}),resendButton:(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.resendButton"),onResendCodeClicked:m}),(0,o.tZ)(n.FormButtonContainer,{children:(0,o.tZ)(n.NavigateToFlowStartButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset})})]})},w=()=>(0,o.tZ)(a.Ej,{title:(0,s.localizationKeys)("signUp.emailLink.verifiedSwitchTab.title"),subtitle:(0,s.localizationKeys)("signUp.emailLink.verifiedSwitchTab.subtitle"),status:"verified"}),R=(0,n.withCardStateProvider)((()=>{var e,t,i;const u=(0,s.localizationKeys)("userProfile.emailAddressPage.title"),m=(0,n.useCardState)(),f=(0,l.useCoreUser)(),p=function(e){const{userSettings:t}=e,{email_address:i}=t.attributes;return i.enabled&&i.verifications.includes("email_link")}((0,l.useEnvironment)()),{params:h}=(0,c.useRouter)(),{id:g}=h||{},v=r.useRef(f.emailAddresses.find((e=>e.id===g))),y=(0,a.a2)({defaultStep:v.current?1:0,onNextStep:()=>m.setError(void 0)}),b=(0,P.Yp)("emailAddress","",{type:"email",label:(0,s.localizationKeys)("formFieldLabel__emailAddress"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__emailAddress"),isRequired:!0}),S=b.value.length>1&&f.username!==b.value;return(0,o.BX)(a.en,{...y.props,children:[(0,o.tZ)(n.ContentPage,{headerTitle:u,Breadcrumbs:d,children:(0,o.BX)(n.Form.Root,{onSubmit:async e=>(e.preventDefault(),f.createEmailAddress({email:b.value}).then((e=>{v.current=e,y.nextStep()})).catch((e=>(0,P.S3)(e,[b],m.setError)))),children:[(0,o.tZ)(n.Form.ControlRow,{elementId:b.id,children:(0,o.tZ)(n.Form.Control,{...b.props,required:!0,autoFocus:!0})}),(0,o.tZ)(s.Text,{localizationKey:p?(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.formHint"):(0,s.localizationKeys)("userProfile.emailAddressPage.emailCode.formHint"),variant:"regularRegular"}),(0,o.tZ)(n.FormButtons,{isDisabled:!S})]})}),(0,o.tZ)(n.ContentPage,{headerTitle:u,Breadcrumbs:d,children:p?(0,o.tZ)(_,{nextStep:y.nextStep,email:v.current}):(0,o.tZ)(K,{nextStep:y.nextStep,identification:v.current,identifier:null===(e=v.current)||void 0===e?void 0:e.emailAddress,prepareVerification:()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.prepareVerification({strategy:"email_code"})}})}),(0,o.tZ)(n.SuccessPage,{title:u,text:p?(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.successMessage",{identifier:(null===(t=v.current)||void 0===t?void 0:t.emailAddress)||""}):(0,s.localizationKeys)("userProfile.emailAddressPage.emailCode.successMessage",{identifier:(null===(i=v.current)||void 0===i?void 0:i.emailAddress)||""}),Breadcrumbs:d})]})}));var x=i(4016),T=i(9820);const A=e=>{const{code:t}=e;return(0,o.tZ)(s.Flex,{center:!0,sx:e=>({backgroundColor:e.colors.$blackAlpha50,padding:`${e.space.$1} ${e.space.$4}`,borderRadius:e.radii.$sm}),children:(0,o.tZ)(s.Text,{children:t})})},k=e=>{const{subtitle:t,backupCodes:i}=e,{applicationName:r}=(0,l.useEnvironment)().displayConfig,n=(0,l.useCoreUser)(),{print:c,printableProps:u}=(0,a.Qz)(),{onCopy:d,hasCopied:m}=(0,h.VP)((null==i?void 0:i.join(","))||""),f=(0,x.xC)(n);return i?(0,o.BX)(o.HY,{children:[(0,o.BX)(s.Col,{gap:1,children:[(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.backupCodePage.title__codelist"),variant:"regularMedium"}),(0,o.tZ)(s.Text,{localizationKey:t,variant:"smallRegular",colorScheme:"neutral"})]}),(0,o.tZ)(s.Grid,{gap:2,sx:e=>({gridTemplateColumns:`repeat(5, minmax(${e.sizes.$12}, 1fr))`,[T.mqu.sm]:{gridTemplateColumns:`repeat(2, minmax(${e.sizes.$12}, 1fr))`}}),children:i.map(((e,t)=>(0,o.tZ)(A,{code:e},t)))}),(0,o.BX)(s.Flex,{gap:6,children:[(0,o.tZ)(s.Button,{variant:"link",colorScheme:"primary",onClick:d,localizationKey:m?(0,s.localizationKeys)("userProfile.backupCodePage.actionLabel__copied"):(0,s.localizationKeys)("userProfile.backupCodePage.actionLabel__copy")}),(0,o.tZ)(s.Button,{variant:"link",colorScheme:"primary",onClick:()=>{const e=document.createElement("a"),t=new Blob([L(i,r,f)],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download=`${r}_backup_codes.txt`,document.body.appendChild(e),e.click()},localizationKey:(0,s.localizationKeys)("userProfile.backupCodePage.actionLabel__download")}),(0,o.tZ)(s.Button,{variant:"link",colorScheme:"primary",onClick:c,localizationKey:(0,s.localizationKeys)("userProfile.backupCodePage.actionLabel__print")})]}),(0,o.BX)(a.o4,{...u,children:[(0,o.BX)(s.Heading,{children:["Your backup codes for ",r," account ",f,":"]}),(0,o.tZ)(s.Col,{gap:2,children:i.map(((e,t)=>(0,o.tZ)(A,{code:e},t)))})]})]}):null};function L(e,t,i){return`These are your backup codes for ${t} account ${i}.\nStore them securely and keep them secret. Each code can only be used once.\n\n${null==e?void 0:e.join("\n")}`}const F=(0,n.withCardStateProvider)((()=>{const e=(0,l.useCoreUser)(),t=(0,n.useCardState)(),[i,a]=r.useState(void 0);return r.useEffect((()=>{i||e.createBackupCode().then((e=>a(e))).catch((e=>(0,P.S3)(e,[],t.setError)))}),[]),t.error?(0,o.tZ)(n.ContentPage,{headerTitle:(0,s.localizationKeys)("userProfile.backupCodePage.title"),Breadcrumbs:d}):(0,o.tZ)(n.ContentPage,{headerTitle:(0,s.localizationKeys)("userProfile.backupCodePage.title"),Breadcrumbs:d,children:i?(0,o.BX)(o.HY,{children:[(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.backupCodePage.successMessage"),variant:"regularRegular"}),(0,o.tZ)(k,{subtitle:(0,s.localizationKeys)("userProfile.backupCodePage.subtitle__codelist"),backupCodes:i.codes}),(0,o.tZ)(n.FormButtonContainer,{children:(0,o.tZ)(n.NavigateToFlowStartButton,{variant:"solid",autoFocus:!0,localizationKey:(0,s.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:s.descriptors.formButtonPrimary})})]}):(0,o.tZ)(n.FullHeightLoader,{})})}));var N=i(4804);const X=(0,n.withCardStateProvider)((()=>{const e=(0,a.a2)();return(0,o.BX)(a.en,{...e.props,children:[(0,o.tZ)(U,{onContinue:e.nextStep}),(0,o.tZ)(F,{})]})})),U=e=>{const{onContinue:t}=e;return(0,o.BX)(n.ContentPage,{headerTitle:(0,s.localizationKeys)("userProfile.backupCodePage.title"),Breadcrumbs:d,children:[(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.backupCodePage.infoText1")}),(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.backupCodePage.infoText2")}),(0,o.BX)(n.FormButtonContainer,{sx:{marginTop:0},children:[(0,o.tZ)(s.Button,{textVariant:"buttonExtraSmallBold",onClick:t,localizationKey:(0,s.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:s.descriptors.formButtonPrimary}),(0,o.tZ)(n.NavigateToFlowStartButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset})]})]})},I=(0,n.withCardStateProvider)((()=>{var e;const t=(0,l.useCoreUser)(),{params:i}=(0,c.useRouter)(),{id:u}=i||{},m=r.useRef(t.phoneNumbers.find((e=>e.id===u))),f=(0,a.a2)({defaultStep:m.current?1:0});return(0,o.BX)(a.en,{...f.props,children:[(0,o.tZ)(E,{resourceRef:m,title:(0,s.localizationKeys)("userProfile.phoneNumberPage.title"),onSuccess:f.nextStep}),(0,o.tZ)(D,{resourceRef:m,title:(0,s.localizationKeys)("userProfile.phoneNumberPage.title"),onSuccess:f.nextStep}),(0,o.tZ)(n.SuccessPage,{title:(0,s.localizationKeys)("userProfile.phoneNumberPage.title"),text:(0,s.localizationKeys)("userProfile.phoneNumberPage.successMessage",{identifier:(null===(e=m.current)||void 0===e?void 0:e.phoneNumber)||""}),Breadcrumbs:d})]})})),E=e=>{const{title:t,onSuccess:i,resourceRef:r}=e,a=(0,n.useCardState)(),c=(0,l.useCoreUser)(),u=(0,P.Yp)("phoneNumber","",{type:"tel",label:(0,s.localizationKeys)("formFieldLabel__phoneNumber"),isRequired:!0}),m=u.value.length>1&&c.username!==u.value;return(0,o.tZ)(n.ContentPage,{headerTitle:t,Breadcrumbs:d,children:(0,o.BX)(n.Form.Root,{onSubmit:async e=>(e.preventDefault(),c.createPhoneNumber({phoneNumber:u.value}).then((e=>{r.current=e,i()})).catch((e=>(0,P.S3)(e,[u],a.setError)))),children:[(0,o.tZ)(n.Form.ControlRow,{elementId:u.id,children:(0,o.tZ)(n.Form.Control,{...u.props,required:!0,autoFocus:!0})}),(0,o.tZ)(s.Text,{variant:"regularRegular",localizationKey:(0,s.localizationKeys)("userProfile.phoneNumberPage.infoText")}),(0,o.tZ)(s.Text,{variant:"smallRegular",colorScheme:"neutral",localizationKey:(0,s.localizationKeys)("userProfile.phoneNumberPage.infoText__secondary")}),(0,o.tZ)(n.FormButtons,{isDisabled:!m})]})})},D=e=>{var t,i;const{title:r,onSuccess:a,resourceRef:l}=e;return(0,o.tZ)(n.ContentPage,{headerTitle:r,Breadcrumbs:d,children:(0,o.tZ)(K,{nextStep:a,identification:l.current,identifier:null===(t=l.current)||void 0===t?void 0:t.phoneNumber,prepareVerification:null===(i=l.current)||void 0===i?void 0:i.prepareVerification})})};var $=i(2362);const M=(0,n.withCardStateProvider)((()=>{var e;const t=r.useRef(),i=(0,a.a2)({defaultStep:2});return(0,o.BX)(a.en,{...i.props,children:[(0,o.tZ)(E,{title:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:t,onSuccess:i.nextStep}),(0,o.tZ)(D,{title:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:t,onSuccess:i.nextStep}),(0,o.tZ)(O,{onSuccess:i.nextStep,onAddPhoneClick:()=>i.goToStep(0),onUnverifiedPhoneClick:e=>{t.current=e,i.goToStep(1)},title:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:t}),(0,o.tZ)(n.SuccessPage,{title:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.title"),text:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage"),contents:(0,o.tZ)(k,{subtitle:(0,s.localizationKeys)("userProfile.backupCodePage.successSubtitle"),backupCodes:null===(e=t.current)||void 0===e?void 0:e.backupCodes}),Breadcrumbs:d})]})})),O=e=>{const{onSuccess:t,title:i,onAddPhoneClick:r,onUnverifiedPhoneClick:a,resourceRef:c}=e,u=(0,n.useCardState)(),m=(0,l.useCoreUser)().phoneNumbers.filter((e=>!e.reservedForSecondFactor));return(0,o.BX)(n.ContentPage,{headerTitle:i,Breadcrumbs:d,children:[(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)(m.length?"userProfile.mfaPhoneCodePage.subtitle__availablePhoneNumbers":"userProfile.mfaPhoneCodePage.subtitle__unavailablePhoneNumbers")}),(0,o.BX)(s.Col,{gap:2,children:[m.map((e=>{const i=(0,P.L_)(e.phoneNumber),r=(0,P.uz)((0,P.y3)(e.phoneNumber).iso);return(0,o.tZ)(n.ArrowBlockButton,{onClick:()=>(async e=>{if("verified"!==e.verification.status)return a(e);u.setLoading(e.id);try{await e.setReservedForSecondFactor({reserved:!0}).then((()=>{c.current=e,t()}))}catch(e){(0,P.S3)(e,[],u.setError)}finally{u.setIdle()}})(e),isLoading:u.loadingMetadata===e.id,isDisabled:u.isLoading,leftIcon:(0,o.tZ)(s.Text,{as:"span",sx:e=>({fontSize:e.fontSizes.$sm}),children:r}),children:i},e.id)})),(0,o.tZ)($.B,{block:!1,onClick:r,textLocalizationKey:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.primaryButton__addPhoneNumber")})]}),(0,o.tZ)(n.FormButtonContainer,{sx:{marginTop:0},children:(0,o.tZ)(n.NavigateToFlowStartButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset")})})]})},H=e=>{const{title:t,onContinue:i}=e,c=(0,l.useCoreUser)(),u=(0,n.useCardState)(),[m,f]=r.useState(void 0),[p,h]=r.useState("qr");return r.useEffect((()=>{c.createTOTP().then((e=>f(e))).catch((e=>(0,P.S3)(e,[],u.setError)))}),[]),u.error?(0,o.tZ)(n.ContentPage,{headerTitle:t}):(0,o.BX)(n.ContentPage,{headerTitle:t,Breadcrumbs:d,children:[!m&&(0,o.tZ)(n.FullHeightLoader,{}),m&&(0,o.BX)(o.HY,{children:[(0,o.BX)(s.Col,{gap:4,children:["qr"==p&&(0,o.BX)(o.HY,{children:[(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__ableToScan")}),(0,o.tZ)(a.s_,{url:m.uri||""}),(0,o.tZ)(s.Button,{variant:"link",onClick:()=>h("uri"),localizationKey:(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonUnableToScan__nonPrimary")})]}),"uri"==p&&(0,o.BX)(o.HY,{children:[(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__unableToScan")}),(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan1")}),(0,o.tZ)(n.ClipboardInput,{value:m.secret}),(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan2")}),(0,o.tZ)(n.ClipboardInput,{value:m.uri}),(0,o.tZ)(s.Button,{variant:"link",onClick:()=>h("qr"),localizationKey:(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonAbleToScan__nonPrimary")})]})]}),(0,o.BX)(n.FormButtonContainer,{sx:{marginTop:0},children:[(0,o.tZ)(s.Button,{textVariant:"buttonExtraSmallBold",onClick:i,localizationKey:(0,s.localizationKeys)("userProfile.formButtonPrimary__continue"),elementDescriptor:s.descriptors.formButtonPrimary}),(0,o.tZ)(n.NavigateToFlowStartButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset})]})]})]})},q=e=>{const{onVerified:t,resourceRef:i}=e,a=(0,n.useCardState)(),c=(0,l.useCoreUser)(),u=(0,h._m)(),[m,f]=r.useState(!1),p=(0,P.Yp)("code",""),g=(0,n.useCodeControl)(p),v=async e=>{(0,P.S3)(e,[p],a.setError),u.setIdle(),await(0,P._v)(750),g.reset()};return g.onCodeEntryFinished((e=>(u.setLoading(),p.setError(void 0),c.verifyTOTP({code:e}).then((e=>(async e=>{f(!0),i.current=e,await(0,P._v)(750),t()})(e))).catch(v)))),(0,o.BX)(n.ContentPage,{headerTitle:(0,s.localizationKeys)("userProfile.mfaTOTPPage.title"),Breadcrumbs:d,children:[(0,o.tZ)(s.Col,{children:(0,o.tZ)(C.T,{title:(0,s.localizationKeys)("userProfile.mfaTOTPPage.verifyTitle"),subtitle:(0,s.localizationKeys)("userProfile.mfaTOTPPage.verifySubtitle"),isLoading:u.isLoading,success:m,codeControl:g})}),(0,o.tZ)(n.FormButtonContainer,{sx:{marginTop:0},children:(0,o.tZ)(n.NavigateToFlowStartButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset})})]})},W=(0,n.withCardStateProvider)((()=>{var e;const t=(0,a.a2)(),i=r.useRef();return(0,o.BX)(a.en,{...t.props,children:[(0,o.tZ)(H,{title:(0,s.localizationKeys)("userProfile.mfaTOTPPage.title"),onContinue:t.nextStep}),(0,o.tZ)(q,{onVerified:t.nextStep,resourceRef:i}),(0,o.tZ)(n.SuccessPage,{title:(0,s.localizationKeys)("userProfile.mfaTOTPPage.title"),text:(0,s.localizationKeys)("userProfile.mfaTOTPPage.successMessage"),contents:(0,o.tZ)(k,{subtitle:(0,s.localizationKeys)("userProfile.backupCodePage.successSubtitle"),backupCodes:null===(e=i.current)||void 0===e?void 0:e.backupCodes}),Breadcrumbs:d})]})})),V=(0,n.withCardStateProvider)((()=>{const e=(0,n.useCardState)(),{userSettings:{attributes:t}}=(0,l.useEnvironment)(),i=(0,l.useCoreUser)(),a=(0,s.localizationKeys)("userProfile.mfaPage.title"),[c,u]=r.useState(),m=r.useMemo((()=>Z(t,i)),[]);return r.useEffect((()=>{0===m.length&&e.setError("There are no second factors available to add")}),[]),e.error?(0,o.tZ)(n.ContentPage,{headerTitle:a,Breadcrumbs:d}):1===m.length||c?(0,o.tZ)(Y,{method:c||m[0]}):(0,o.BX)(n.ContentPage,{headerTitle:a,Breadcrumbs:d,children:[(0,o.BX)(s.Col,{gap:4,children:[(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.mfaPage.formHint")}),(0,o.tZ)(s.Grid,{gap:2,sx:e=>({gridTemplateColumns:`repeat(3, minmax(${e.sizes.$24}, 1fr))`,gridAutoRows:e.sizes.$24,[T.mqu.sm]:{gridTemplateColumns:`repeat(2, minmax(${e.sizes.$24}, 1fr))`}}),children:m.map(((e,t)=>(0,o.tZ)(j,{method:e,setSelectedMethod:u},t)))})]}),(0,o.tZ)(n.FormButtonContainer,{sx:{marginTop:0},children:(0,o.tZ)(n.NavigateToFlowStartButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset")})})]})})),Y=e=>{const{method:t}=e;switch(t){case"phone_code":return(0,o.tZ)(M,{});case"totp":return(0,o.tZ)(W,{});case"backup_code":return(0,o.tZ)(X,{});default:return null}},j=e=>{const{method:t,setSelectedMethod:i}=e;let r,a;if("phone_code"===t)r=N.ij,a="SMS code";else if("totp"===t)r=N.hc,a="Authenticator application";else{if("backup_code"!==t)return null;r=N.TZ,a="Backup code"}return(0,o.tZ)(n.TileButton,{icon:r,onClick:()=>i(t),children:a})},G=(e,t)=>{const i=[];return e?i.push((0,s.localizationKeys)("userProfile.passwordPage.changePasswordSuccessMessage")):i.push((0,s.localizationKeys)("userProfile.passwordPage.successMessage")),t&&i.push((0,s.localizationKeys)("userProfile.passwordPage.sessionsSignedOutSuccessMessage")),i},Q=(0,n.withCardStateProvider)((()=>{const e=(0,l.useCoreUser)(),t=(0,l.useCoreSession)(),i=e.passwordEnabled?(0,s.localizationKeys)("userProfile.passwordPage.changePasswordTitle"):(0,s.localizationKeys)("userProfile.passwordPage.title"),c=(0,n.useCardState)(),u=(0,a.a2)(),{navigateToFlowStart:m}=(0,h.zk)(),f=e.samlAccounts.some((e=>e.active)),p=(0,r.useRef)({title:(0,s.localizationKeys)("userProfile.passwordPage.title")}),g=(0,P.Yp)("currentPassword","",{type:"password",label:(0,s.localizationKeys)("formFieldLabel__currentPassword"),isRequired:!0}),{userSettings:{passwordSettings:v}}=(0,l.useEnvironment)(),y=(0,P.Yp)("newPassword","",{type:"password",label:(0,s.localizationKeys)("formFieldLabel__newPassword"),isRequired:!0,validatePassword:!0,buildErrorMessage:e=>(0,P.GM)(e,{t:C,locale:K,passwordSettings:v})}),b=(0,P.Yp)("confirmPassword","",{type:"password",label:(0,s.localizationKeys)("formFieldLabel__confirmPassword"),isRequired:!0}),S=(0,P.Yp)("signOutOfOtherSessions","",{type:"checkbox",label:(0,s.localizationKeys)("formFieldLabel__signOutOfOtherSessions"),defaultChecked:!0}),{setConfirmPasswordFeedback:z,isPasswordMatch:Z}=(0,h.p5)({passwordField:y,confirmPasswordField:b}),{t:C,locale:K}=(0,s.useLocalizations)(),B=(e.passwordEnabled?g.value&&Z:Z)&&y.value&&b.value;return(0,o.BX)(a.en,{...u.props,children:[(0,o.BX)(n.ContentPage,{headerTitle:i,Breadcrumbs:d,children:[f&&(0,o.tZ)(n.InformationBox,{message:(0,s.localizationKeys)("userProfile.passwordPage.readonly")}),(0,o.BX)(n.Form.Root,{onSubmit:async()=>{const t={newPassword:y.value,signOutOfOtherSessions:S.checked,currentPassword:e.passwordEnabled?g.value:void 0};try{p.current={title:e.passwordEnabled?(0,s.localizationKeys)("userProfile.passwordPage.changePasswordTitle"):(0,s.localizationKeys)("userProfile.passwordPage.title"),text:G(e.passwordEnabled,!!S.checked),Breadcrumbs:d},await e.updatePassword(t),u.nextStep()}catch(e){(0,P.S3)(e,[g,y,b],c.setError)}},onBlur:()=>{y.value&&z(b.value)},children:[(0,o.tZ)("input",{readOnly:!0,id:"identifier-field",name:"identifier",value:t.publicUserData.identifier||"",style:{display:"none"}}),e.passwordEnabled&&(0,o.tZ)(n.Form.ControlRow,{elementId:g.id,children:(0,o.tZ)(n.Form.Control,{...g.props,minLength:6,required:!0,autoFocus:!0,isDisabled:f})}),(0,o.tZ)(n.Form.ControlRow,{elementId:y.id,children:(0,o.tZ)(n.Form.Control,{...y.props,minLength:6,required:!0,autoFocus:!e.passwordEnabled,isDisabled:f})}),(0,o.tZ)(n.Form.ControlRow,{elementId:b.id,children:(0,o.tZ)(n.Form.Control,{...b.props,onChange:e=>(e.target.value&&z(e.target.value),b.props.onChange(e)),isDisabled:f})}),(0,o.tZ)(n.Form.ControlRow,{elementId:S.id,children:(0,o.tZ)(n.Form.Control,{...S.props,isDisabled:f})}),f?(0,o.tZ)(n.FormButtonContainer,{children:(0,o.tZ)(n.Form.ResetButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:m})}):(0,o.tZ)(n.FormButtons,{isDisabled:!B})]})]}),(0,o.tZ)(n.SuccessPage,{...p.current})]})}));var J=i(4334);const ee=e=>{const{user:t,...i}=e;return(0,o.tZ)(n.AvatarUploader,{...i,title:(0,J.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,o.tZ)(n.UserAvatar,{size:e=>e.sizes.$11,...t})})},te=(0,n.withCardStateProvider)((()=>{const e=(0,s.localizationKeys)("userProfile.profilePage.title"),t=(0,n.useCardState)(),i=(0,l.useCoreUser)(),[c,u]=r.useState(!1),{first_name:m,last_name:f}=(0,l.useEnvironment)().userSettings.attributes,h=m.enabled,g=f.enabled,v=i.firstName||"",y=i.lastName||"",b=(0,a.a2)({onNextStep:()=>t.setError(void 0)}),S=(0,P.Yp)("firstName",i.firstName||"",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__firstName")}),z=(0,P.Yp)("lastName",i.lastName||"",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__lastName")}),Z=h&&S.value!==v||g&&z.value!==y,C=Z||c,K=h&&m.required||g&&f.required,B=K&&!!z.value&&!!S.value&&C,_=i.samlAccounts.some((e=>e.active));return(0,o.BX)(a.en,{...b.props,children:[(0,o.BX)(n.ContentPage,{headerTitle:e,Breadcrumbs:d,children:[_&&(0,o.tZ)(n.InformationBox,{message:(0,s.localizationKeys)("userProfile.profilePage.readonly")}),(0,o.BX)(n.Form.Root,{onSubmit:async e=>(e.preventDefault(),(Z?i.update({firstName:S.value,lastName:z.value}):Promise.resolve()).then((()=>{b.nextStep()})).catch((e=>{(0,P.S3)(e,[S,z],t.setError)}))),children:[(0,o.tZ)(ee,{user:i,onAvatarChange:e=>i.setProfileImage({file:e}).then((()=>{u(!0),t.setIdle()})).catch((e=>(0,P.S3)(e,[],t.setError))),onAvatarRemove:(0,p.QO)(i.imageUrl)?null:()=>{i.setProfileImage({file:null}).then((()=>{u(!0),t.setIdle()})).catch((e=>(0,P.S3)(e,[],t.setError)))}}),h&&(0,o.tZ)(n.Form.ControlRow,{elementId:S.id,children:(0,o.tZ)(n.Form.Control,{autoFocus:!0,...S.props,required:m.required,isDisabled:_})}),g&&(0,o.tZ)(n.Form.ControlRow,{elementId:z.id,children:(0,o.tZ)(n.Form.Control,{...z.props,required:f.required,isDisabled:_})}),(0,o.tZ)(n.FormButtons,{isDisabled:K?!B:!C})]})]}),(0,o.tZ)(n.SuccessPage,{title:e,text:(0,s.localizationKeys)("userProfile.profilePage.successMessage"),Breadcrumbs:d})]})})),ie=()=>{const e=(0,l.useCoreUser)(),{id:t}=(0,c.useRouter)().params,i=e.emailAddresses.find((e=>e.id===t)),n=r.useRef(null==i?void 0:i.emailAddress);return n.current?(0,o.tZ)(a.hH,{title:(0,s.localizationKeys)("userProfile.emailAddressPage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine1",{identifier:n.current}),messageLine2:(0,s.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine2"),successMessage:(0,s.localizationKeys)("userProfile.emailAddressPage.removeResource.successMessage",{emailAddress:n.current}),deleteResource:()=>Promise.resolve(null==i?void 0:i.destroy()),Breadcrumbs:d}):null},oe=()=>{const e=(0,l.useCoreUser)(),{id:t}=(0,c.useRouter)().params,i=e.phoneNumbers.find((e=>e.id===t)),n=r.useRef(null==i?void 0:i.phoneNumber);return n.current?(0,o.tZ)(a.hH,{title:(0,s.localizationKeys)("userProfile.phoneNumberPage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine1",{identifier:n.current}),messageLine2:(0,s.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine2"),successMessage:(0,s.localizationKeys)("userProfile.phoneNumberPage.removeResource.successMessage",{phoneNumber:n.current}),deleteResource:()=>Promise.resolve(null==i?void 0:i.destroy()),Breadcrumbs:d}):null},re=()=>{var e,t;const i=(0,l.useCoreUser)(),{id:n}=(0,c.useRouter)().params,u=i.externalAccounts.find((e=>e.id===n)),m=r.useRef(null==u?void 0:u.provider),{providerToDisplayData:f}=(0,h.vO)();return m.current?(0,o.tZ)(a.hH,{title:(0,s.localizationKeys)("userProfile.connectedAccountPage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine1",{identifier:null===(e=f[m.current])||void 0===e?void 0:e.name}),messageLine2:(0,s.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine2"),successMessage:(0,s.localizationKeys)("userProfile.connectedAccountPage.removeResource.successMessage",{connectedAccount:null===(t=f[m.current])||void 0===t?void 0:t.name}),deleteResource:()=>Promise.resolve(null==u?void 0:u.destroy()),Breadcrumbs:d}):null},ae=()=>{const e=(0,l.useCoreUser)(),{id:t}=(0,c.useRouter)().params,i=e.web3Wallets.find((e=>e.id===t)),n=r.useRef(null==i?void 0:i.web3Wallet);return n.current?(0,o.tZ)(a.hH,{title:(0,s.localizationKeys)("userProfile.web3WalletPage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine1",{identifier:n.current}),messageLine2:(0,s.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine2"),successMessage:(0,s.localizationKeys)("userProfile.web3WalletPage.removeResource.successMessage",{web3Wallet:n.current}),deleteResource:()=>Promise.resolve(null==i?void 0:i.destroy()),Breadcrumbs:d}):null},le=()=>{const e=(0,l.useCoreUser)(),{id:t}=(0,c.useRouter)().params,i=e.phoneNumbers.find((e=>e.id===t)),n=r.useRef(null==i?void 0:i.phoneNumber);return n.current?(0,o.tZ)(a.hH,{title:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine1",{identifier:n.current}),messageLine2:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine2"),successMessage:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.successMessage",{mfaPhoneCode:n.current}),deleteResource:()=>Promise.resolve(null==i?void 0:i.setReservedForSecondFactor({reserved:!1})),Breadcrumbs:d}):null},se=()=>{const e=(0,l.useCoreUser)();return(0,o.tZ)(a.hH,{title:(0,s.localizationKeys)("userProfile.mfaTOTPPage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine1"),messageLine2:(0,s.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine2"),successMessage:(0,s.localizationKeys)("userProfile.mfaTOTPPage.removeResource.successMessage"),deleteResource:e.disableTOTP,Breadcrumbs:d})};var ne=i(6465),ce=i(869);const ue=e=>{const t="modal"===(0,l.useUserProfileContext)().mode;return(0,o.tZ)(n.AccordionItem,{scrollOnOpen:t,...e})},de=()=>{const e=(0,l.useCoreUser)(),t=(0,l.useCoreSession)(),[i,a]=r.useState([]);return r.useEffect((()=>{null==e||e.getSessions().then((e=>a(e)))}),[e]),(0,o.BX)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.activeDevicesSection.title"),id:"activeDevices",children:[!i.length&&(0,o.tZ)(n.FullHeightLoader,{}),!!i.length&&i.sort((c=null==t?void 0:t.id,e=>e.id===c?-1:1)).map((e=>(0,o.tZ)(me,{session:e},e.id)))]});var c},me=e=>{var t;const i=(null===(t=(0,l.useCoreSession)())||void 0===t?void 0:t.id)===e.session.id;return(0,o.tZ)(ue,{elementDescriptor:s.descriptors.activeDeviceListItem,elementId:i?s.descriptors.activeDeviceListItem.setId("current"):void 0,title:(0,o.tZ)(fe,{session:e.session}),children:(0,o.BX)(s.Col,{gap:4,children:[i&&(0,o.tZ)(ce.f,{subtitle:(0,s.localizationKeys)("userProfile.start.activeDevicesSection.detailsSubtitle"),title:(0,s.localizationKeys)("userProfile.start.activeDevicesSection.detailsTitle")}),!i&&(0,o.tZ)(ce.f,{actionLabel:(0,s.localizationKeys)("userProfile.start.activeDevicesSection.destructiveAction"),colorScheme:"danger",onClick:async()=>{if(!i&&e.session)return e.session.revoke()},subtitle:(0,s.localizationKeys)("userProfile.start.activeDevicesSection.destructiveActionSubtitle"),title:(0,s.localizationKeys)("userProfile.start.activeDevicesSection.destructiveActionTitle")})]})})},fe=e=>{const t=(0,l.useCoreSession)(),i=(null==t?void 0:t.id)===e.session.id,r=!!t.actor,a=!!e.session.actor,{city:n,country:c,browserName:u,browserVersion:d,deviceType:m,ipAddress:f,isMobile:p}=e.session.latestActivity,h=m||(p?"Mobile device":"Desktop device"),g=`${u||""} ${d||""}`.trim()||"Web browser",v=[n||"",c||""].filter(Boolean).join(", ").trim()||null,{t:y}=(0,s.useLocalizations)();return(0,o.BX)(s.Flex,{elementDescriptor:s.descriptors.activeDevice,elementId:i?s.descriptors.activeDevice.setId("current"):void 0,align:"center",sx:e=>({gap:e.space.$8,[T.mqu.xs]:{gap:e.space.$2}}),children:[(0,o.tZ)(s.Flex,{center:!0,sx:e=>({padding:`0 ${e.space.$3}`,[T.mqu.sm]:{padding:"0"},borderRadius:e.radii.$md}),children:(0,o.tZ)(s.Icon,{elementDescriptor:s.descriptors.activeDeviceIcon,elementId:s.descriptors.activeDeviceIcon.setId(p?"mobile":"desktop"),icon:p?N.Fh:N.eu,sx:e=>({"--cl-chassis-bottom":"#444444","--cl-chassis-back":"#343434","--cl-chassis-screen":"#575757","--cl-screen":"#000000",width:e.space.$20,height:e.space.$20,[T.mqu.sm]:{width:e.space.$10,height:e.space.$10}})})}),(0,o.BX)(s.Col,{align:"start",gap:1,children:[(0,o.BX)(s.Flex,{center:!0,gap:2,children:[(0,o.tZ)(s.Text,{variant:"smallMedium",children:h}),i&&(0,o.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__thisDevice"),colorScheme:r?"danger":"primary"}),r&&!a&&(0,o.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__userDevice")}),!i&&a&&(0,o.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__otherImpersonatorDevice"),colorScheme:"danger"})]}),(0,o.tZ)(s.Text,{variant:"smallRegular",colorScheme:"neutral",children:g}),(0,o.BX)(s.Text,{variant:"smallRegular",colorScheme:"neutral",children:[f," (",v,")"]}),(0,o.tZ)(s.Text,{variant:"smallRegular",colorScheme:"neutral",children:y((0,P.Qg)(e.session.lastActiveAt))})]})]})},pe=()=>{const e=(0,l.useCoreUser)(),{navigate:t}=(0,c.useRouter)(),i=[...e.verifiedExternalAccounts,...e.unverifiedExternalAccounts.filter((e=>{var t;return null===(t=e.verification)||void 0===t?void 0:t.error}))];return(0,o.BX)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.title"),id:"connectedAccounts",children:[i.map((e=>(0,o.tZ)(he,{account:e},e.id))),(0,o.tZ)($.B,{textLocalizationKey:(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.primaryButton"),id:"connectedAccounts",onClick:()=>t("connected-account")})]})},he=({account:e})=>{var t,i,r,a,u;const d=(0,n.useCardState)(),m=(0,l.useCoreUser)(),{navigate:f}=(0,c.useRouter)(),g=(0,c.useRouter)(),{providerToDisplayData:v}=(0,h.vO)(),y=null===(i=null===(t=e.verification)||void 0===t?void 0:t.error)||void 0===i?void 0:i.longMessage,b=e.username||e.emailAddress,S=!!(null===(r=g.urlStateParam)||void 0===r?void 0:r.componentName),{additionalOAuthScopes:z,componentName:Z,mode:C}=(0,l.useUserProfileContext)(),K="modal"===C,B=e.provider===(null===(a=g.urlStateParam)||void 0===a?void 0:a.socialProvider),_=function(e,t){if(!t)return[];const i=t[e.provider]||[],o=e.approvedScopes.split(" ");return 0===i.filter((e=>!o.includes(e))).length?[]:i}(e,z),w=_.length>0&&""!=e.approvedScopes,R=w?(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.title__reauthorize"):(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.title__connectionFailed"),x=w?(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.subtitle__reauthorize"):y,T=w?(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.actionLabel__reauthorize"):(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.actionLabel__connectionFailed");return(0,o.tZ)(ue,{defaultOpen:B&&S,onCloseCallback:null===(u=g.urlStateParam)||void 0===u?void 0:u.clearUrlStateParam,icon:(0,o.tZ)(s.Image,{elementDescriptor:[s.descriptors.providerIcon],elementId:s.descriptors.socialButtonsProviderIcon.setId(e.provider),alt:v[e.provider].name,src:v[e.provider].iconUrl,sx:e=>({width:e.sizes.$4})}),title:(0,o.BX)(s.Flex,{gap:2,center:!0,children:[`${v[e.provider].name} ${b?`(${b})`:""}`,(y||w)&&(0,o.tZ)(s.Badge,{colorScheme:"danger",textVariant:"extraSmallMedium",localizationKey:(0,s.localizationKeys)("badge__requiresAction")})]}),children:(0,o.BX)(s.Col,{gap:4,children:[(0,o.tZ)(n.UserPreview,{externalAccount:e,size:"lg",icon:(0,o.tZ)(s.Image,{alt:v[e.provider].name,src:v[e.provider].iconUrl,sx:e=>({width:e.sizes.$4})})}),(y||w)&&(0,o.tZ)(ce.f,{title:R,subtitle:x,actionLabel:T,onClick:async()=>{var t;const i=K?(0,p.bX)({url:window.location.href,componentName:Z}):window.location.href;try{let o;o=w?await e.reauthorize({additionalScopes:_,redirectUrl:i}):await m.createExternalAccount({strategy:e.verification.strategy,redirectUrl:i,additionalScopes:_}),await f((null===(t=o.verification.externalVerificationRedirectURL)||void 0===t?void 0:t.href)||"")}catch(e){(0,P.S3)(e,[],d.setError)}}}),(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionTitle"),subtitle:(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionSubtitle"),actionLabel:(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionAccordionSubtitle"),colorScheme:"danger",onClick:()=>f(`connected-account/${e.id}/remove`)})]})})},Pe=()=>{const{navigate:e}=(0,c.useRouter)();return(0,o.tZ)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.dangerSection.title"),id:"danger",children:(0,o.BX)(s.Flex,{justify:"between",sx:e=>({marginTop:e.space.$2,marginLeft:e.space.$6}),children:[(0,o.BX)(s.Col,{gap:1,children:[(0,o.tZ)(s.Text,{variant:"regularMedium",localizationKey:(0,s.localizationKeys)("userProfile.start.dangerSection.deleteAccountTitle")}),(0,o.tZ)(s.Text,{variant:"smallRegular",colorScheme:"neutral",localizationKey:(0,s.localizationKeys)("userProfile.start.dangerSection.deleteAccountDescription")})]}),(0,o.tZ)(s.Button,{"aria-label":"Delete account",colorScheme:"danger",textVariant:"buttonExtraSmallBold",onClick:()=>e("delete"),localizationKey:(0,s.localizationKeys)("userProfile.start.dangerSection.deleteAccountButton")})]})})},ge=()=>{const{navigate:e}=(0,c.useRouter)(),t=(0,l.useCoreUser)();return(0,o.BX)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.title"),id:"emailAddresses",children:[t.emailAddresses.sort(b(t.primaryEmailAddressId)).map((e=>(0,o.tZ)(ve,{email:e},e.id))),(0,o.tZ)($.B,{textLocalizationKey:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.primaryButton"),id:"emailAddresses",onClick:()=>e("email-address")})]})},ve=({email:e})=>{const t=(0,n.useCardState)(),i=(0,l.useCoreUser)(),{navigate:r}=(0,c.useRouter)(),a=i.primaryEmailAddressId===e.id,u="verified"===e.verification.status;return(0,o.tZ)(ue,{title:e.emailAddress,badge:(0,o.BX)(o.HY,{children:[a&&(0,o.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__primary"),textVariant:"extraSmallMedium"}),!u&&(0,o.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__unverified"),colorScheme:"danger",textVariant:"extraSmallMedium"})]}),children:(0,o.BX)(s.Col,{gap:4,children:[a&&u&&(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsTitle__primary"),subtitle:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsSubtitle__primary")}),a&&!u&&(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsTitle__primary"),subtitle:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsSubtitle__primary"),actionLabel:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__primary"),onClick:()=>r(`email-address/${e.id}`)}),!a&&u&&(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsTitle__nonPrimary"),subtitle:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsSubtitle__nonPrimary"),actionLabel:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__nonPrimary"),onClick:()=>i.update({primaryEmailAddressId:e.id}).catch((e=>(0,P.S3)(e,[],t.setError)))}),!a&&!u&&(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsTitle__unverified"),subtitle:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsSubtitle__unverified"),actionLabel:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__unverified"),onClick:()=>r(`email-address/${e.id}`)}),(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.destructiveActionTitle"),subtitle:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.destructiveActionSubtitle"),actionLabel:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.destructiveAction"),colorScheme:"danger",onClick:()=>r(`email-address/${e.id}/remove`)})]})})},ye=()=>{const e=(0,l.useCoreUser)();return(0,o.tZ)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.enterpriseAccountsSection.title"),id:"enterpriseAccounts",children:e.samlAccounts.map((e=>(0,o.tZ)(be,{account:e},e.id)))})},be=({account:e})=>{var t,i,r;const a=(0,c.useRouter)(),{getSamlProviderLogoUrl:l,getSamlProviderName:u}=(0,h.n$)(),d=null===(i=null===(t=e.verification)||void 0===t?void 0:t.error)||void 0===i?void 0:i.longMessage,m=e.emailAddress,f=u(e.provider),p=l(e.provider);return(0,o.tZ)(ue,{onCloseCallback:null===(r=a.urlStateParam)||void 0===r?void 0:r.clearUrlStateParam,icon:(0,o.tZ)(s.Image,{elementDescriptor:[s.descriptors.providerIcon],elementId:s.descriptors.enterpriseButtonsProviderIcon.setId(e.provider),alt:f,src:p,sx:e=>({width:e.sizes.$4})}),title:(0,o.BX)(s.Flex,{gap:2,center:!0,children:[`${f} ${m?`(${m})`:""}`,d&&(0,o.tZ)(s.Badge,{colorScheme:"danger",localizationKey:(0,s.localizationKeys)("badge__requiresAction")})]}),children:(0,o.tZ)(s.Col,{gap:4,children:(0,o.tZ)(n.UserPreview,{samlAccount:e,size:"lg",icon:(0,o.tZ)(s.Image,{alt:f,src:p,sx:e=>({width:e.sizes.$4})})})})})},Se=()=>{const{navigate:e}=(0,c.useRouter)(),{t:t}=(0,s.useLocalizations)();return(0,o.tZ)(ue,{icon:(0,o.tZ)(s.Icon,{icon:N.TZ,sx:e=>({color:e.colors.$blackAlpha700})}),title:t((0,s.localizationKeys)("userProfile.start.mfaSection.backupCodes.headerTitle")),children:(0,o.tZ)(s.Col,{gap:4,children:(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.mfaSection.backupCodes.title__regenerate"),subtitle:(0,s.localizationKeys)("userProfile.start.mfaSection.backupCodes.subtitle__regenerate"),actionLabel:(0,s.localizationKeys)("userProfile.start.mfaSection.backupCodes.actionLabel__regenerate"),onClick:()=>e("multi-factor/backup_code/add")})})})},ze=({phone:e,showTOTP:t})=>{const{navigate:i}=(0,c.useRouter)(),r=(0,n.useCardState)(),a=!t&&e.defaultSecondFactor;return(0,o.tZ)(ue,{icon:(0,o.tZ)(s.Icon,{icon:N.ij,sx:e=>({color:e.colors.$blackAlpha700})}),title:(0,o.BX)(o.HY,{children:["SMS Code ",(0,o.tZ)(n.FormattedPhoneNumberText,{value:e.phoneNumber})]}),badge:a?(0,o.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__default")}):void 0,children:(0,o.BX)(s.Col,{gap:4,children:[!t&&(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)(a?"userProfile.start.mfaSection.phoneCode.title__default":"userProfile.start.mfaSection.phoneCode.title__setDefault"),subtitle:(0,s.localizationKeys)(a?"userProfile.start.mfaSection.phoneCode.subtitle__default":"userProfile.start.mfaSection.phoneCode.subtitle__setDefault"),actionLabel:a?void 0:(0,s.localizationKeys)("userProfile.start.mfaSection.phoneCode.actionLabel__setDefault"),onClick:()=>e.makeDefaultSecondFactor().catch((e=>(0,P.S3)(e,[],r.setError)))}),(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionTitle"),subtitle:(0,s.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionSubtitle"),actionLabel:(0,s.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionLabel"),colorScheme:"danger",onClick:()=>i(`multi-factor/${e.id}/remove`)})]})})},Ze=()=>{const{navigate:e}=(0,c.useRouter)(),{t:t}=(0,s.useLocalizations)();return(0,o.tZ)(ue,{icon:(0,o.tZ)(s.Icon,{icon:N.hc,sx:e=>({color:e.colors.$blackAlpha700})}),title:t((0,s.localizationKeys)("userProfile.start.mfaSection.totp.headerTitle")),badge:(0,o.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__default")}),children:(0,o.BX)(s.Col,{gap:4,children:[(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.mfaSection.totp.title"),subtitle:(0,s.localizationKeys)("userProfile.start.mfaSection.totp.subtitle")}),(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionTitle"),subtitle:(0,s.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionSubtitle"),actionLabel:(0,s.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionLabel"),colorScheme:"danger",onClick:()=>e("multi-factor/totp/remove")})]})})},Ce=()=>{const{navigate:e}=(0,c.useRouter)(),{userSettings:{attributes:t}}=(0,l.useEnvironment)(),i=(0,l.useCoreUser)(),r=z(t),a=Z(t,i),u=r.includes("totp")&&i.totpEnabled,d=r.includes("backup_code")&&i.backupCodeEnabled,m=i.phoneNumbers.filter((e=>"verified"===e.verification.status)).filter((e=>e.reservedForSecondFactor)).sort(S);return(0,o.BX)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.mfaSection.title"),id:"mfa",children:[u&&(0,o.tZ)(Ze,{}),r.includes("phone_code")&&m.map((e=>(0,o.tZ)(ze,{phone:e,showTOTP:u},e.id))),d&&(0,o.tZ)(Se,{}),a.length>0&&(0,o.tZ)($.B,{textLocalizationKey:(0,s.localizationKeys)("userProfile.start.mfaSection.primaryButton"),id:"mfa",onClick:()=>e("multi-factor")})]})},Ke=()=>{const{navigate:e}=(0,c.useRouter)(),{passwordEnabled:t}=(0,l.useCoreUser)();return(0,o.BX)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.passwordSection.title"),id:"password",children:[t&&(0,o.tZ)(s.Text,{variant:"smallRegular",sx:e=>({padding:`${e.space.$2} ${e.space.$4}`}),children:"••••••••••"}),(0,o.tZ)($.B,{id:"password",onClick:()=>e("password"),leftIcon:t?N.z:void 0,textLocalizationKey:t?(0,s.localizationKeys)("userProfile.start.passwordSection.primaryButton__changePassword"):(0,s.localizationKeys)("userProfile.start.passwordSection.primaryButton__setPassword")})]})},Be=()=>{const e=(0,l.useCoreUser)(),{navigate:t}=(0,c.useRouter)();return(0,o.BX)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.title"),id:"phoneNumbers",children:[e.phoneNumbers.sort(b(e.primaryPhoneNumberId)).map((e=>(0,o.tZ)(_e,{phone:e},e.id))),(0,o.tZ)($.B,{textLocalizationKey:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.primaryButton"),id:"password",onClick:()=>t("phone-number")})]})},_e=({phone:e})=>{const t=(0,n.useCardState)(),i=(0,l.useCoreUser)(),{navigate:r}=(0,c.useRouter)(),a=i.primaryPhoneNumberId===e.id,u="verified"===e.verification.status,d=(0,P.L_)(e.phoneNumber),m=(0,P.uz)((0,P.y3)(e.phoneNumber).iso);return(0,o.tZ)(ue,{icon:(0,o.tZ)(s.Text,{as:"span",sx:e=>({fontSize:e.fontSizes.$sm}),children:m}),title:d,badge:(0,o.BX)(o.HY,{children:[a&&(0,o.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__primary"),textVariant:"extraSmallMedium"}),!u&&(0,o.tZ)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__unverified"),colorScheme:"danger",textVariant:"extraSmallMedium"})]}),children:(0,o.BX)(s.Col,{gap:4,children:[a&&u&&(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsTitle__primary"),subtitle:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsSubtitle__primary")}),a&&!u&&(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsTitle__primary"),subtitle:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsSubtitle__primary"),actionLabel:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__primary"),onClick:()=>r(`phone-number/${e.id}`)}),!a&&u&&(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsTitle__nonPrimary"),subtitle:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsSubtitle__nonPrimary"),actionLabel:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__nonPrimary"),onClick:()=>i.update({primaryPhoneNumberId:e.id}).catch((e=>(0,P.S3)(e,[],t.setError)))}),!a&&!u&&(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsTitle__unverified"),subtitle:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsSubtitle__unverified"),actionLabel:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__unverified"),onClick:()=>r(`phone-number/${e.id}`)}),(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveActionTitle"),subtitle:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveActionSubtitle"),actionLabel:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveAction"),colorScheme:"danger",onClick:()=>r(`phone-number/${e.id}/remove`)})]})})},we=()=>{const e=(0,l.useCoreUser)(),{navigate:t}=(0,c.useRouter)();return(0,o.BX)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.usernameSection.title"),id:"username",children:[e.username&&(0,o.tZ)(s.Text,{variant:"smallRegular",sx:e=>({padding:`${e.space.$2} ${e.space.$4}`}),children:e.username}),(0,o.tZ)($.B,{id:"username",onClick:()=>t("username"),leftIcon:e.username?N.z:void 0,textLocalizationKey:e.username?(0,s.localizationKeys)("userProfile.start.usernameSection.primaryButton__changeUsername"):(0,s.localizationKeys)("userProfile.start.usernameSection.primaryButton__setUsername")})]})},Re=()=>{const{navigate:e}=(0,c.useRouter)(),{username:t,primaryEmailAddress:i,primaryPhoneNumber:r,...a}=(0,l.useCoreUser)();return(0,o.tZ)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.profileSection.title"),id:"profile",children:(0,o.tZ)($.o,{onClick:()=>e("profile"),children:(0,o.tZ)(n.UserPreview,{user:a,size:"lg"})})})},xe=()=>{const e=(0,l.useCoreUser)(),{navigate:t}=(0,c.useRouter)();return(0,o.BX)(n.ProfileSection,{title:(0,s.localizationKeys)("userProfile.start.web3WalletsSection.title"),id:"web3Wallets",children:[e.web3Wallets.map((e=>(0,o.tZ)(Te,{wallet:e},e.id))),(0,o.tZ)($.B,{id:"password",onClick:()=>t("web3-wallet"),textLocalizationKey:(0,s.localizationKeys)("userProfile.start.web3WalletsSection.primaryButton")})]})},Te=({wallet:e})=>{const{navigate:t}=(0,c.useRouter)(),{strategyToDisplayData:i}=(0,h.vO)(),r=e.verification.strategy;return(0,o.tZ)(ue,{title:(0,o.BX)(s.Flex,{align:"center",gap:4,children:[(0,o.tZ)(s.Image,{src:i[r].iconUrl,alt:i[r].name,sx:e=>({width:e.sizes.$4})}),i[r].name," (",e.web3Wallet,")"]}),children:(0,o.tZ)(s.Col,{gap:4,children:(0,o.tZ)(ce.f,{title:(0,s.localizationKeys)("userProfile.start.web3WalletsSection.destructiveActionTitle"),subtitle:(0,s.localizationKeys)("userProfile.start.web3WalletsSection.destructiveActionSubtitle"),actionLabel:(0,s.localizationKeys)("userProfile.start.web3WalletsSection.destructiveAction"),colorScheme:"danger",onClick:()=>t(`web3-wallet/${e.id}/remove`)})})})},Ae=(0,n.withCardStateProvider)((()=>{const{attributes:e,saml:t,social:i,instanceIsPasswordBased:r}=(0,l.useEnvironment)().userSettings,a=(0,n.useCardState)(),c=(0,l.useCoreUser)(),u=e.username.enabled,d=e.email_address.enabled,m=e.phone_number.enabled,f=i&&Object.values(i).filter((e=>e.enabled)).length>0,p=t&&t.enabled&&c.samlAccounts.length>0,h=e.web3_wallet.enabled,P=r,g=z(e).length>0,v=c.deleteSelfEnabled;return(0,o.BX)(s.Col,{elementDescriptor:s.descriptors.page,gap:8,children:[(0,o.tZ)(ne.ap,{}),(0,o.tZ)(n.CardAlert,{children:a.error}),(0,o.BX)(s.Col,{elementDescriptor:s.descriptors.profilePage,elementId:s.descriptors.profilePage.setId("account"),gap:8,children:[(0,o.BX)(n.Header.Root,{id:"cl-section-account",children:[(0,o.tZ)(n.Header.Title,{localizationKey:(0,s.localizationKeys)("userProfile.start.headerTitle__account"),textVariant:"xxlargeMedium"}),(0,o.tZ)(n.Header.Subtitle,{localizationKey:(0,s.localizationKeys)("userProfile.start.headerSubtitle__account")})]}),(0,o.tZ)(Re,{}),u&&(0,o.tZ)(we,{}),d&&(0,o.tZ)(ge,{}),m&&(0,o.tZ)(Be,{}),f&&(0,o.tZ)(pe,{}),p&&(0,o.tZ)(ye,{}),h&&(0,o.tZ)(xe,{})]}),(0,o.BX)(s.Col,{elementDescriptor:s.descriptors.profilePage,elementId:s.descriptors.profilePage.setId("security"),gap:8,children:[(0,o.BX)(n.Header.Root,{id:"cl-section-security",children:[(0,o.tZ)(n.Header.Title,{localizationKey:(0,s.localizationKeys)("userProfile.start.headerTitle__security"),textVariant:"xxlargeMedium"}),(0,o.tZ)(n.Header.Subtitle,{localizationKey:(0,s.localizationKeys)("userProfile.start.headerSubtitle__security")})]}),P&&(0,o.tZ)(Ke,{}),g&&(0,o.tZ)(Ce,{}),(0,o.tZ)(de,{}),v&&(0,o.tZ)(Pe,{})]})]})})),ke=(0,n.withCardStateProvider)((()=>{const e=(0,l.useCoreUser)(),{userSettings:t}=(0,l.useEnvironment)(),i=(0,n.useCardState)(),r=(0,a.a2)(),c=(0,P.Yp)("username",e.username||"",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__username"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__username")}),u=(!t.attributes.username.required||c.value.length>1)&&e.username!==c.value;return(0,o.BX)(a.en,{...r.props,children:[(0,o.tZ)(n.ContentPage,{headerTitle:(0,s.localizationKeys)("userProfile.usernamePage.title"),Breadcrumbs:d,children:(0,o.BX)(n.Form.Root,{onSubmit:async()=>{try{await e.update({username:c.value}),r.nextStep()}catch(e){(0,P.S3)(e,[c],i.setError)}},children:[(0,o.tZ)(n.Form.ControlRow,{elementId:c.id,children:(0,o.tZ)(n.Form.Control,{...c.props,required:!0,autoFocus:!0})}),(0,o.tZ)(n.FormButtons,{isDisabled:!u})]})}),(0,o.tZ)(n.SuccessPage,{title:(0,s.localizationKeys)("userProfile.usernamePage.title"),text:(0,s.localizationKeys)("userProfile.usernamePage.successMessage"),Breadcrumbs:d})]})}));var Le=i(8621);const Fe=(0,n.withCardStateProvider)((()=>{const e=(0,l.useCoreUser)(),{params:t}=(0,c.useRouter)(),{id:i}=t||{},u=r.useRef(e.web3Wallets.find((e=>e.id===i))),m=(0,a.a2)({defaultStep:u.current?1:0});return(0,o.BX)(a.en,{...m.props,children:[(0,o.tZ)(Ne,{nextStep:m.nextStep}),(0,o.tZ)(n.SuccessPage,{title:(0,s.localizationKeys)("userProfile.web3WalletPage.title"),text:(0,s.localizationKeys)("userProfile.web3WalletPage.successMessage"),Breadcrumbs:d})]})})),Ne=e=>{const{nextStep:t}=e,i=(0,n.useCardState)(),r=(0,l.useCoreUser)(),{strategyToDisplayData:a}=(0,h.vO)(),c=0===r.web3Wallets.filter((e=>{var t;return"verified"===(null===(t=e.verification)||void 0===t?void 0:t.status)})).length?["web3_metamask_signature"]:[];return(0,o.BX)(n.ContentPage,{headerTitle:(0,s.localizationKeys)("userProfile.web3WalletPage.title"),Breadcrumbs:d,children:[(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)(c.length?"userProfile.web3WalletPage.subtitle__availableWallets":"userProfile.web3WalletPage.subtitle__unavailableWallets")}),(0,o.tZ)(s.Col,{gap:2,children:c.map((e=>(0,o.tZ)(n.ArrowBlockButton,{id:a[e].id,onClick:()=>(async e=>{try{i.setLoading(e);const o=await(0,Le.M)();let a=await r.createWeb3Wallet({web3Wallet:o});a=await a.prepareVerification({strategy:"web3_metamask_signature"});const l=a.verification.nonce,s=await(0,Le.w)({identifier:o,nonce:l});await a.attemptVerification({signature:s}),i.setIdle(),t()}catch(e){i.setIdle(),console.log(e);const t=(0,P.zQ)(e);t?i.setError(t.longMessage):(0,P.S3)(e,[],i.setError)}})(e),isLoading:i.loadingMetadata===e,isDisabled:i.isLoading,leftIcon:(0,o.tZ)(s.Image,{elementDescriptor:s.descriptors.socialButtonsProviderIcon,elementId:s.descriptors.socialButtonsProviderIcon.setId(a[e].id),isLoading:i.loadingMetadata===e,isDisabled:i.isLoading,src:a[e].iconUrl,alt:`Connect ${a[e].name}`,sx:e=>({width:e.sizes.$5})}),children:`Connect ${a[e].name} wallet`},e)))}),(0,o.tZ)(n.FormButtonContainer,{sx:{marginTop:0},children:(0,o.tZ)(n.NavigateToFlowStartButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset")})})]})},Xe=e=>{var t;const{pages:i}=(0,l.useUserProfileContext)(),r=i.routes[0].id===f.x.ACCOUNT||i.routes[0].id===f.x.SECURITY,a=null===(t=i.contents)||void 0===t?void 0:t.map(((e,t)=>{const i=!r&&0===t;return(0,o.tZ)(c.Route,{index:i,path:i?void 0:e.url,children:(0,o.tZ)(m.O,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)}));return(0,o.tZ)(n.ProfileCardContent,{contentRef:e.contentRef,children:(0,o.BX)(c.Switch,{children:[a,(0,o.BX)(c.Route,{path:r?void 0:"account",children:[(0,o.tZ)(c.Route,{path:"profile",flowStart:!0,children:(0,o.tZ)(te,{})}),(0,o.tZ)(c.Route,{path:"email-address",flowStart:!0,children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:":id/remove",children:(0,o.tZ)(ie,{})}),(0,o.tZ)(c.Route,{path:":id",children:(0,o.tZ)(R,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(R,{})})]})}),(0,o.tZ)(c.Route,{path:"phone-number",flowStart:!0,children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:":id/remove",children:(0,o.tZ)(oe,{})}),(0,o.tZ)(c.Route,{path:":id",children:(0,o.tZ)(I,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(I,{})})]})}),(0,o.tZ)(c.Route,{path:"multi-factor",flowStart:!0,children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:"totp/remove",children:(0,o.tZ)(se,{})}),(0,o.tZ)(c.Route,{path:"backup_code/add",children:(0,o.tZ)(F,{})}),(0,o.tZ)(c.Route,{path:":id/remove",children:(0,o.tZ)(le,{})}),(0,o.tZ)(c.Route,{path:":id",children:(0,o.tZ)(V,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(V,{})})]})}),(0,o.tZ)(c.Route,{path:"connected-account",flowStart:!0,children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:":id/remove",children:(0,o.tZ)(re,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(g,{})})]})}),(0,o.tZ)(c.Route,{path:"web3-wallet",flowStart:!0,children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:":id/remove",children:(0,o.tZ)(ae,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(Fe,{})})]})}),(0,o.tZ)(c.Route,{path:"username",flowStart:!0,children:(0,o.tZ)(ke,{})}),(0,o.tZ)(c.Route,{path:"password",flowStart:!0,children:(0,o.tZ)(Q,{})}),(0,o.tZ)(c.Route,{path:"delete",flowStart:!0,children:(0,o.tZ)(y,{})}),(0,o.tZ)(c.Route,{index:!0,children:(0,o.tZ)(Ae,{})})]})]})})},Ue=(0,l.withCoreUserGuard)((()=>{const e=r.useRef(null);return(0,o.tZ)(n.ProfileCard,{sx:{height:"100%"},children:(0,o.tZ)(u,{contentRef:e,children:(0,o.tZ)(Xe,{contentRef:e})})})})),Ie=(0,a.ZP)((0,n.withCardStateProvider)((e=>(0,o.tZ)(s.Flow.Root,{flow:"userProfile",children:(0,o.tZ)(s.Flow.Part,{children:(0,o.BX)(c.Switch,{children:[(0,o.tZ)(c.Route,{path:"verify",children:(0,o.tZ)(w,{})}),(0,o.tZ)(c.Route,{children:(0,o.tZ)(Ue,{})})]})})})))),Ee=e=>{const t={...e,routing:"virtual",componentName:"UserProfile",mode:"modal"};return(0,o.tZ)(c.Route,{path:"user",children:(0,o.tZ)(l.ComponentContext.Provider,{value:t,children:(0,o.tZ)("div",{children:(0,o.tZ)(Ie,{...t})})})})}}}]);